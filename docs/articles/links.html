<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Multistage deterministic linkage in R • diyar</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Multistage deterministic linkage in R">
<meta property="og:description" content="diyar">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">diyar</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/episodes.html">Implementing case definitions for epidemiological analysis in R</a>
    </li>
    <li>
      <a href="../articles/links.html">Multistage deterministic linkage in R</a>
    </li>
    <li>
      <a href="../articles/number_line.html">Number lines and overlaps</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/OlisaNsonwu/diyar/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="links_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Multistage deterministic linkage in R</h1>
            
            <h4 class="date">28 March 2021</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/OlisaNsonwu/diyar/blob/master/vignettes/links.Rmd"><code>vignettes/links.Rmd</code></a></small>
      <div class="hidden name"><code>links.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>Linking datasets to consolidate information is a common task in research, particularly in those using “big data”. Deterministic record linkage is the simplest and most common method of doing this. However, its accuracy relies on data quality. <code><a href="../reference/links.html">links()</a></code> provides a convenient and flexible approach of doing this while handing missing or incorrect data.</p>
</div>
<div id="uses" class="section level1">
<h1 class="hasAnchor">
<a href="#uses" class="anchor"></a>Uses</h1>
<p><code><a href="../reference/links.html">links()</a></code> can be used to link datasets in a variety of ways. Examples include;</p>
<ul>
<li>Linking datasets on one (or more) matching <code>criteria</code>
</li>
<li>Linking datasets on one (or more) matching <code>criteria</code> and one (or more) matching <code>sub_criteria</code>. See <a href="#record_matching">record matching</a>
</li>
<li>Linking datasets in stages. Each stage is considered more relevant than the subsequent one. See <a href="#record_expansion">group expansion</a>
</li>
<li>Linking datasets with missing group identifiers. See <a href="#missing_values">handling missing values</a>
</li>
</ul>
</div>
<div id="implementation" class="section level1">
<h1 class="hasAnchor">
<a href="#implementation" class="anchor"></a>Implementation</h1>
<p>Data matching is done in ordered stages. A match at each stage is considered more relevant than those at subsequent stages. Matched records are assigned a record group identifier. This is the record identifier (<code>sn</code>) of one of the matching records therefore, a familiar <code>sn</code> can prove useful.</p>
<p>Each matching stage has an attribute or characteristic to match (<code>criteria</code>). These must be passed as a <code>list</code> of <code>atomic</code> vectors.</p>
<p>Additional matching conditions (<code>sub_criteria</code>) can also be specified at each stage. This is done by supplying a <code>list</code> of <code>sub_crieria()</code>. Each <code><a href="../reference/sub_criteria.html">sub_criteria()</a></code> must be paired to a stage (<code>criteria</code>). This is done by naming each element in the list, using the syntax - <code>"cr[n]"</code>. Where <code>n</code> is the corresponding stage (<code>criteria</code>) of interest (<a href="#sub_cri_example">See examples</a>). Any unpaired <code>sub_criteria</code> will be ignored. Records will only be assigned to the same group if they have the same <code>criteria</code>, and at least one matching attribute in each <code><a href="../reference/sub_criteria.html">sub_criteria()</a></code>. See examples below.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">diyar</span>);
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">patient_list</span>);
<span class="no">dbs</span> <span class="kw">&lt;-</span> <span class="no">patient_list</span>[<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"forename"</span>,<span class="st">"surname"</span>,<span class="st">"sex"</span>)]; <span class="no">dbs</span>
<span class="co">#&gt;   forename surname sex</span>
<span class="co">#&gt; 1    James   Green   M</span>
<span class="co">#&gt; 2   ESTHER  Kulmar   F</span>
<span class="co">#&gt; 3     &lt;NA&gt;     OBI   F</span>
<span class="co">#&gt; 4    Jamey   Green   M</span>
<span class="co">#&gt; 5   Daniel  Kulmar   M</span>
<span class="co">#&gt; 6    Henry     OBI   M</span>

<span class="co"># 1 stage &lt;- Matching surname only</span>
<span class="no">dbs</span>$<span class="no">pids_a</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/links.html">links</a></span>(<span class="kw">criteria</span> <span class="kw">=</span> <span class="no">dbs</span>$<span class="no">surname</span>, <span class="kw">display</span> <span class="kw">=</span> <span class="st">"none"</span>, <span class="kw">group_stats</span> <span class="kw">=</span> <span class="no">T</span>)

<span class="co"># 2 stage - Matching surname, then matching sex</span>
<span class="no">dbs</span>$<span class="no">pids_b</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/links.html">links</a></span>(<span class="kw">criteria</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="no">dbs</span>$<span class="no">surname</span>, <span class="no">dbs</span>$<span class="no">sex</span>), <span class="kw">display</span> <span class="kw">=</span> <span class="st">"none"</span>)

<span class="no">dbs</span>
<span class="co">#&gt;   forename surname sex        pids_a        pids_b</span>
<span class="co">#&gt; 1    James   Green   M P.1 (CRI 001) P.1 (CRI 001)</span>
<span class="co">#&gt; 2   ESTHER  Kulmar   F P.2 (CRI 001) P.2 (CRI 001)</span>
<span class="co">#&gt; 3     &lt;NA&gt;     OBI   F P.3 (CRI 001) P.3 (CRI 001)</span>
<span class="co">#&gt; 4    Jamey   Green   M P.1 (CRI 001) P.1 (CRI 001)</span>
<span class="co">#&gt; 5   Daniel  Kulmar   M P.2 (CRI 001) P.2 (CRI 001)</span>
<span class="co">#&gt; 6    Henry     OBI   M P.3 (CRI 001) P.3 (CRI 001)</span></pre></body></html></div>
<p>Matched records are assigned to record groups. These are stored as <code>pid</code> objects (<code>S4</code> object class). A <code>pid</code> object is a group identifier with <code>slots</code> for additional information about each group.</p>
<p>For a <code>pid</code> object created in multiple stages (<code>criteria</code>), the following information will be displayed (<code>format.pid</code>);</p>
<ul>
<li>
<code>P.1</code> - group identifier</li>
<li>
<code>CRI 001</code> - stage when that record was linked</li>
</ul>
<p><em>See <code><a href="../reference/links.html">?links</a></code> for further details.</em></p>
<p><em>to_df() transforms <code>pid</code> objects to <code>data.frames</code>.</em></p>
<pre><code>#&gt; to_df(`pid`)
#&gt;   pid sn pid_cri link_id pid_total iteration
#&gt; 1   1  1       1       1         2         1
#&gt; 2   2  2       1       2         2         1
#&gt; 3   3  3       1       3         2         1
#&gt; 4   1  4       1       1         2         1
#&gt; 5   2  5       1       2         2         1
#&gt; 6   3  6       1       3         2         1</code></pre>
<p><a id="record_matching"></a></p>
<div id="record-matching" class="section level2">
<h2 class="hasAnchor">
<a href="#record-matching" class="anchor"></a>Record matching</h2>
<p>Attributes are checked for a case sensitive exact match. Those supplied via a <code><a href="../reference/sub_criteria.html">sub_criteria()</a></code> can also be compared by any <code>logical</code> test applicable to two <code>atomic</code> vectors. The logical test must be supplied as a <code>function</code>. This function must have two named arguments - <code>x</code> and <code>y</code>. Where <code>y</code> is the value for one observation to be compared against all other observations (<code>x</code>). See some examples below.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">dbs2</span> <span class="kw">&lt;-</span> <span class="no">patient_list</span>[<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"forename"</span>,<span class="st">"surname"</span>,<span class="st">"sex"</span>)]; <span class="no">dbs2</span>
<span class="co">#&gt;   forename surname sex</span>
<span class="co">#&gt; 1    James   Green   M</span>
<span class="co">#&gt; 2   ESTHER  Kulmar   F</span>
<span class="co">#&gt; 3     &lt;NA&gt;     OBI   F</span>
<span class="co">#&gt; 4    Jamey   Green   M</span>
<span class="co">#&gt; 5   Daniel  Kulmar   M</span>
<span class="co">#&gt; 6    Henry     OBI   M</span>

<span class="co"># Matching `sex`, and `forename` initials</span>
<span class="no">lgl_1</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">x</span>, <span class="no">y</span>) <span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span>(<span class="no">x</span>, <span class="fl">1</span>, <span class="fl">1</span>) <span class="kw">==</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span>(<span class="no">y</span>, <span class="fl">1</span>, <span class="fl">1</span>)
<span class="no">dbs2</span>$<span class="no">pids_1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/links.html">links</a></span>(<span class="kw">criteria</span> <span class="kw">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="no">dbs2</span>$<span class="no">sex</span>),
                     <span class="kw">sub_criteria</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
                       <span class="kw">cr1</span> <span class="kw">=</span> <span class="fu"><a href="../reference/sub_criteria.html">sub_criteria</a></span>(<span class="no">dbs2</span>$<span class="no">forename</span>, <span class="kw">match_funcs</span> <span class="kw">=</span> <span class="no">lgl_1</span>)),
                     <span class="kw">display</span> <span class="kw">=</span> <span class="st">"none"</span>)

<span class="co"># Matching `sex`, and `forename` with character length of 5</span>
<span class="no">lgl_2</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">x</span>, <span class="no">y</span>) <span class="fu"><a href="https://rdrr.io/r/base/nchar.html">nchar</a></span>(<span class="no">x</span>) <span class="kw">==</span> <span class="fu"><a href="https://rdrr.io/r/base/nchar.html">nchar</a></span>(<span class="no">y</span>) <span class="kw">&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/nchar.html">nchar</a></span>(<span class="no">x</span>) <span class="kw">==</span> <span class="fl">5</span>
<span class="no">dbs2</span>$<span class="no">pids_2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/links.html">links</a></span>(<span class="kw">criteria</span> <span class="kw">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="no">dbs2</span>$<span class="no">sex</span>),
                    <span class="kw">sub_criteria</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
                      <span class="kw">cr1</span> <span class="kw">=</span> <span class="fu"><a href="../reference/sub_criteria.html">sub_criteria</a></span>(<span class="no">dbs2</span>$<span class="no">forename</span>, <span class="kw">match_funcs</span> <span class="kw">=</span> <span class="no">lgl_2</span>)),
                    <span class="kw">display</span> <span class="kw">=</span> <span class="st">"none"</span>)

<span class="co"># Matching `sex`, and `forename` that ends with "y"</span>
<span class="no">lgl_3</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">x</span>, <span class="no">y</span>) <span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span>(<span class="no">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">x</span>) - <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">x</span>)) <span class="kw">==</span> <span class="st">"y"</span>
<span class="no">dbs2</span>$<span class="no">pids_3</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/links.html">links</a></span>(<span class="kw">criteria</span> <span class="kw">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="no">dbs2</span>$<span class="no">sex</span>),
                    <span class="kw">sub_criteria</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
                      <span class="kw">cr1</span> <span class="kw">=</span> <span class="fu"><a href="../reference/sub_criteria.html">sub_criteria</a></span>(<span class="no">dbs2</span>$<span class="no">forename</span>, <span class="kw">match_funcs</span> <span class="kw">=</span> <span class="no">lgl_3</span>)),
                    <span class="kw">display</span> <span class="kw">=</span> <span class="st">"none"</span>)

<span class="co"># Matching `sex` and at least one `forename` that ends with "y"</span>
<span class="no">lgl_4</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">x</span>, <span class="no">y</span>) <span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span>(<span class="no">y</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">y</span>) - <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">y</span>)) <span class="kw">==</span> <span class="st">"y"</span>
<span class="no">dbs2</span>$<span class="no">pids_4</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/links.html">links</a></span>(<span class="kw">criteria</span> <span class="kw">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="no">dbs2</span>$<span class="no">sex</span>),
                    <span class="kw">sub_criteria</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
                      <span class="kw">cr1</span> <span class="kw">=</span> <span class="fu"><a href="../reference/sub_criteria.html">sub_criteria</a></span>(<span class="no">dbs2</span>$<span class="no">forename</span>, <span class="kw">match_funcs</span> <span class="kw">=</span> <span class="no">lgl_4</span>)),
                    <span class="kw">display</span> <span class="kw">=</span> <span class="st">"none"</span>)</pre></body></html></div>
<p>User-defined logical tests can be very useful for implementing complex matching conditions. For example, you can match observations if they are within a range or list of values. See the example below.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">Opes_c</span> <span class="kw">&lt;-</span> <span class="no">Opes</span>[<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"date_of_birth"</span>, <span class="st">"name"</span>, <span class="st">"hair_colour"</span>)]
<span class="no">Opes_c</span> <span class="kw">&lt;-</span> <span class="no">Opes</span>[<span class="st">"date_of_birth"</span>]
<span class="co"># approximate age</span>
<span class="no">Opes_c</span>$<span class="no">age</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span>((<span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.Date</a></span>() - <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span>(<span class="no">Opes_c</span>$<span class="no">date_of_birth</span>, <span class="st">"%d/%m/%Y"</span>))/<span class="fl">365.5</span>))

<span class="co"># Match individuals between ages 35 and 55 </span>
<span class="no">rng1</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">x</span>, <span class="no">y</span>) <span class="no">x</span> <span class="kw">%in%</span> <span class="fl">35</span>:<span class="fl">55</span>
<span class="no">Opes_c</span>$<span class="no">pids_a</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/links.html">links</a></span>(<span class="kw">criteria</span> <span class="kw">=</span> <span class="st">"place_holder"</span>,
                       <span class="kw">sub_criteria</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">cr1</span> <span class="kw">=</span> <span class="fu"><a href="../reference/sub_criteria.html">sub_criteria</a></span>(<span class="no">Opes_c</span>$<span class="no">age</span>, <span class="kw">match_funcs</span> <span class="kw">=</span> <span class="no">rng1</span>)),
                       <span class="kw">display</span> <span class="kw">=</span><span class="st">"none"</span>)

<span class="co"># Match individuals with a 5-year age gap between themselves</span>
<span class="no">rng2</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">x</span>, <span class="no">y</span>) <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span>(<span class="no">y</span> - <span class="no">x</span>) <span class="kw">%in%</span> <span class="fl">0</span>:<span class="fl">5</span>
<span class="no">Opes_c</span>$<span class="no">pids_b</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/links.html">links</a></span>(<span class="kw">criteria</span> <span class="kw">=</span> <span class="st">"place_holder"</span>,
                       <span class="kw">sub_criteria</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">cr1</span> <span class="kw">=</span> <span class="fu"><a href="../reference/sub_criteria.html">sub_criteria</a></span>(<span class="no">Opes_c</span>$<span class="no">age</span>, <span class="kw">match_funcs</span> <span class="kw">=</span> <span class="no">rng2</span>)),
                       <span class="kw">display</span> <span class="kw">=</span><span class="st">"none"</span>)

<span class="co"># Match individuals with more than a 5-year age gap between each other </span>
<span class="no">rng3</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">x</span>, <span class="no">y</span>) (<span class="no">y</span> - <span class="no">x</span>) <span class="kw">&gt;</span> <span class="fl">5</span>
<span class="no">Opes_c</span>$<span class="no">pids_c</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/links.html">links</a></span>(<span class="kw">criteria</span> <span class="kw">=</span> <span class="st">"place_holder"</span>,
                       <span class="kw">sub_criteria</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">cr1</span> <span class="kw">=</span> <span class="fu"><a href="../reference/sub_criteria.html">sub_criteria</a></span>(<span class="no">Opes_c</span>$<span class="no">age</span>, <span class="kw">match_funcs</span> <span class="kw">=</span> <span class="no">rng3</span>)),
                       <span class="kw">display</span> <span class="kw">=</span><span class="st">"none"</span>)

<span class="no">Opes_c</span>[<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"age"</span>,<span class="st">"pids_a"</span>, <span class="st">"pids_b"</span>, <span class="st">"pids_c"</span>)]
<span class="co">#&gt;   age        pids_a        pids_b        pids_c</span>
<span class="co">#&gt; 1  35 P.6 (CRI 001) P.1 (CRI 001) P.6 (CRI 001)</span>
<span class="co">#&gt; 2  35 P.6 (CRI 001) P.1 (CRI 001) P.6 (CRI 001)</span>
<span class="co">#&gt; 3  53 P.6 (CRI 001) P.3 (CRI 001) P.6 (CRI 001)</span>
<span class="co">#&gt; 4  36 P.6 (CRI 001) P.1 (CRI 001) P.6 (CRI 001)</span>
<span class="co">#&gt; 5  36 P.6 (CRI 001) P.1 (CRI 001) P.6 (CRI 001)</span>
<span class="co">#&gt; 6  57 P.6 (CRI 001) P.3 (CRI 001) P.6 (CRI 001)</span>
<span class="co">#&gt; 7  57 P.7 (No hits) P.3 (CRI 001) P.7 (No hits)</span>
<span class="co">#&gt; 8  35 P.6 (CRI 001) P.1 (CRI 001) P.6 (CRI 001)</span></pre></body></html></div>
<p><code><a href="../reference/links.html">links()</a></code> goes through repeated checks for matches based on the logical test specified. At each iteration, one observation (<code>y</code>) is compared with every other observation (<code>x</code>). As a result, two observations (i.e. <code>x[2]</code> and <code>x[3]</code>) can pass the same logical test compared with a third observation (i.e. <code>y</code>). But not pass the same test when compared with each other. As an example, in <code>Opes_c$pids_c</code> above, records 1, 2, 4, 5 and 8 are within a 5-year gap of each other. This has happened because there’s more than a 5-year gap between themselves and record 7.</p>
<p>Always aim for the combination of conditions that’ll give more true positive matches. Linking records on matching surnames and then sex (<code>pid_b</code>) led to a different result. Compared to linking on sex before surnames (<code>pid_c</code> below) (See <a href="#record_expansion">group expansion</a>). In <code>pid_b</code>, a match on the individual’s surname was considered more relevant than a match on their sex. The opposite was the case for <code>pid_c</code>.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">dbs</span>$<span class="no">pids_c</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/links.html">links</a></span>(<span class="kw">criteria</span> <span class="kw">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="no">dbs</span>$<span class="no">sex</span>, <span class="no">dbs</span>$<span class="no">surname</span>), <span class="kw">display</span> <span class="kw">=</span> <span class="st">"none"</span>)

<span class="no">dbs</span>
<span class="co">#&gt;   forename surname sex        pids_a        pids_b        pids_c</span>
<span class="co">#&gt; 1    James   Green   M P.1 (CRI 001) P.1 (CRI 001) P.1 (CRI 001)</span>
<span class="co">#&gt; 2   ESTHER  Kulmar   F P.2 (CRI 001) P.2 (CRI 001) P.2 (CRI 001)</span>
<span class="co">#&gt; 3     &lt;NA&gt;     OBI   F P.3 (CRI 001) P.3 (CRI 001) P.2 (CRI 001)</span>
<span class="co">#&gt; 4    Jamey   Green   M P.1 (CRI 001) P.1 (CRI 001) P.1 (CRI 001)</span>
<span class="co">#&gt; 5   Daniel  Kulmar   M P.2 (CRI 001) P.2 (CRI 001) P.1 (CRI 001)</span>
<span class="co">#&gt; 6    Henry     OBI   M P.3 (CRI 001) P.3 (CRI 001) P.1 (CRI 001)</span></pre></body></html></div>
<p>Both results are logically correct but <code>pids_b</code> is not the most practical option. For instance, records 3 and 6 which were linked but could be cousins and not the same individual. A better combination would be forename at stage 1, followed by surname and sex at stage 2. See <code>pid_d</code> below;</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="no">dbs_2</span> <span class="kw">&lt;-</span> <span class="no">patient_list</span>; <span class="no">dbs_2</span>
<span class="co">#&gt;   rd_id forename surname sex</span>
<span class="co">#&gt; 1     1    James   Green   M</span>
<span class="co">#&gt; 2     2   ESTHER  Kulmar   F</span>
<span class="co">#&gt; 3     3     &lt;NA&gt;     OBI   F</span>
<span class="co">#&gt; 4     4    Jamey   Green   M</span>
<span class="co">#&gt; 5     5   Daniel  Kulmar   M</span>
<span class="co">#&gt; 6     6    Henry     OBI   M</span>

<span class="no">dbs_2</span>$<span class="no">cri_2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="no">dbs_2</span>$<span class="no">surname</span>, <span class="no">dbs_2</span>$<span class="no">sex</span>,<span class="kw">sep</span><span class="kw">=</span><span class="st">"-"</span>)
<span class="no">dbs_2</span>$<span class="no">pid_d</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/links.html">links</a></span>(<span class="kw">sn</span> <span class="kw">=</span> <span class="no">dbs_2</span>$<span class="no">rd_id</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="no">dbs_2</span>$<span class="no">forename</span>, <span class="no">dbs_2</span>$<span class="no">cri_2</span>), <span class="kw">display</span> <span class="kw">=</span> <span class="st">"none"</span>)

<span class="no">dbs_2</span>
<span class="co">#&gt;   rd_id forename surname sex    cri_2         pid_d</span>
<span class="co">#&gt; 1     1    James   Green   M  Green-M P.1 (CRI 002)</span>
<span class="co">#&gt; 2     2   ESTHER  Kulmar   F Kulmar-F P.2 (No hits)</span>
<span class="co">#&gt; 3     3     &lt;NA&gt;     OBI   F    OBI-F P.3 (No hits)</span>
<span class="co">#&gt; 4     4    Jamey   Green   M  Green-M P.1 (CRI 002)</span>
<span class="co">#&gt; 5     5   Daniel  Kulmar   M Kulmar-M P.5 (No hits)</span>
<span class="co">#&gt; 6     6    Henry     OBI   M    OBI-M P.6 (No hits)</span></pre></body></html></div>
<p><img src="links_files/figure-html/unnamed-chunk-8-1.png" width="816"></p>
<p><img src="links_files/figure-html/unnamed-chunk-9-1.png" width="816"></p>
<p><a id="sub_cri_example"></a></p>
<p>Below are additional examples using different combinations of the same <code>criteria</code> and <code>sub_criteria</code></p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">Opes</span>); <span class="no">Opes</span>
<span class="co">#&gt;   rd_id name  department hair_colour date_of_birth db_pt1  db_pt2  db_pt3</span>
<span class="co">#&gt; 1     1  Ope Procurement       Brown    23/03/1986  23/03 23/1986 03/1986</span>
<span class="co">#&gt; 2     2  Ope    Security       Brown    23/03/1986  23/03 23/1986 03/1986</span>
<span class="co">#&gt; 3     3  Ope    Security       Brown    23/03/1968  23/03 23/1968 03/1968</span>
<span class="co">#&gt; 4     4  Ope  Publishing       Green    01/02/1985  01/02 01/1985 02/1985</span>
<span class="co">#&gt; 5     5  Ope  Publishing        Teal    02/01/1985  02/01 02/1985 01/1985</span>
<span class="co">#&gt; 6     6  Ope  Publishing        Grey    11/03/1964  11/03 11/1964 03/1964</span>
<span class="co">#&gt; 7     7  Ope  Publishing       White    11/03/1964  11/03 11/1964 03/1964</span>
<span class="co">#&gt; 8     8  Ope Procurement       Black    11/10/1985  11/10 11/1985 10/1985</span>

<span class="co"># 1 stage linkage</span>
  <span class="co"># stage 1 - name AND (department OR hair_colour OR date_of_birth)</span>
<span class="no">Opes</span>$<span class="no">pids_a</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/links.html">links</a></span>(<span class="kw">criteria</span> <span class="kw">=</span> <span class="no">Opes</span>$<span class="no">name</span>,
                     <span class="kw">sub_criteria</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">cr1</span> <span class="kw">=</span> <span class="fu"><a href="../reference/sub_criteria.html">sub_criteria</a></span>(<span class="no">Opes</span>$<span class="no">department</span>,
                                                            <span class="no">Opes</span>$<span class="no">hair_colour</span>,
                                                            <span class="no">Opes</span>$<span class="no">date_of_birth</span>)),
                     <span class="kw">display</span> <span class="kw">=</span> <span class="st">"none"</span>
                     )

<span class="no">Opes</span>[<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"name"</span>,<span class="st">"department"</span>,<span class="st">"hair_colour"</span>,<span class="st">"date_of_birth"</span>,<span class="st">"pids_a"</span>)]
<span class="co">#&gt;   name  department hair_colour date_of_birth        pids_a</span>
<span class="co">#&gt; 1  Ope Procurement       Brown    23/03/1986 P.1 (CRI 001)</span>
<span class="co">#&gt; 2  Ope    Security       Brown    23/03/1986 P.1 (CRI 001)</span>
<span class="co">#&gt; 3  Ope    Security       Brown    23/03/1968 P.1 (CRI 001)</span>
<span class="co">#&gt; 4  Ope  Publishing       Green    01/02/1985 P.4 (CRI 001)</span>
<span class="co">#&gt; 5  Ope  Publishing        Teal    02/01/1985 P.4 (CRI 001)</span>
<span class="co">#&gt; 6  Ope  Publishing        Grey    11/03/1964 P.4 (CRI 001)</span>
<span class="co">#&gt; 7  Ope  Publishing       White    11/03/1964 P.4 (CRI 001)</span>
<span class="co">#&gt; 8  Ope Procurement       Black    11/10/1985 P.1 (CRI 001)</span>

<span class="co"># 1 stage linkage </span>
  <span class="co"># stage 1 - name AND ((department OR hair_colour) AND (date_of_birth)) </span>
<span class="no">Opes</span>$<span class="no">pids_b</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/links.html">links</a></span>(<span class="kw">criteria</span> <span class="kw">=</span> <span class="no">Opes</span>$<span class="no">name</span>,
                     <span class="kw">sub_criteria</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">cr1</span> <span class="kw">=</span> <span class="fu"><a href="../reference/sub_criteria.html">sub_criteria</a></span>(<span class="no">Opes</span>$<span class="no">department</span>,
                                                            <span class="no">Opes</span>$<span class="no">hair_colour</span>),
                                         <span class="kw">cr1</span> <span class="kw">=</span> <span class="fu"><a href="../reference/sub_criteria.html">sub_criteria</a></span>(<span class="no">Opes</span>$<span class="no">date_of_birth</span>)),
                     <span class="kw">display</span> <span class="kw">=</span> <span class="st">"none"</span>)

<span class="no">Opes</span>[<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"name"</span>,<span class="st">"department"</span>,<span class="st">"hair_colour"</span>,<span class="st">"date_of_birth"</span>,<span class="st">"pids_b"</span>)]
<span class="co">#&gt;   name  department hair_colour date_of_birth        pids_b</span>
<span class="co">#&gt; 1  Ope Procurement       Brown    23/03/1986 P.1 (CRI 001)</span>
<span class="co">#&gt; 2  Ope    Security       Brown    23/03/1986 P.1 (CRI 001)</span>
<span class="co">#&gt; 3  Ope    Security       Brown    23/03/1968 P.1 (CRI 001)</span>
<span class="co">#&gt; 4  Ope  Publishing       Green    01/02/1985 P.4 (CRI 001)</span>
<span class="co">#&gt; 5  Ope  Publishing        Teal    02/01/1985 P.4 (CRI 001)</span>
<span class="co">#&gt; 6  Ope  Publishing        Grey    11/03/1964 P.4 (CRI 001)</span>
<span class="co">#&gt; 7  Ope  Publishing       White    11/03/1964 P.4 (CRI 001)</span>
<span class="co">#&gt; 8  Ope Procurement       Black    11/10/1985 P.1 (CRI 001)</span>

<span class="co"># 1 stage linkage </span>
  <span class="co"># stage 1 - name AND ((department OR hair_colour) AND (dd-mm OR dd-yyyy OR mm-yyyy))</span>
<span class="no">Opes</span>$<span class="no">pids_c</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/links.html">links</a></span>(<span class="kw">criteria</span> <span class="kw">=</span> <span class="no">Opes</span>$<span class="no">name</span>,
                     <span class="kw">sub_criteria</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">cr1</span> <span class="kw">=</span> <span class="fu"><a href="../reference/sub_criteria.html">sub_criteria</a></span>(<span class="no">Opes</span>$<span class="no">department</span>,
                                                            <span class="no">Opes</span>$<span class="no">hair_colour</span>),
                                         <span class="kw">cr1</span> <span class="kw">=</span> <span class="fu"><a href="../reference/sub_criteria.html">sub_criteria</a></span>(<span class="no">Opes</span>$<span class="no">db_pt1</span>, <span class="no">Opes</span>$<span class="no">db_pt2</span>, <span class="no">Opes</span>$<span class="no">db_pt3</span>)),
                            <span class="kw">display</span> <span class="kw">=</span> <span class="st">"none"</span>)

<span class="no">Opes</span>[<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"name"</span>,<span class="st">"department"</span>,<span class="st">"hair_colour"</span>,<span class="st">"date_of_birth"</span>,<span class="st">"pids_c"</span>)]
<span class="co">#&gt;   name  department hair_colour date_of_birth        pids_c</span>
<span class="co">#&gt; 1  Ope Procurement       Brown    23/03/1986 P.1 (CRI 001)</span>
<span class="co">#&gt; 2  Ope    Security       Brown    23/03/1986 P.1 (CRI 001)</span>
<span class="co">#&gt; 3  Ope    Security       Brown    23/03/1968 P.1 (CRI 001)</span>
<span class="co">#&gt; 4  Ope  Publishing       Green    01/02/1985 P.4 (CRI 001)</span>
<span class="co">#&gt; 5  Ope  Publishing        Teal    02/01/1985 P.4 (CRI 001)</span>
<span class="co">#&gt; 6  Ope  Publishing        Grey    11/03/1964 P.4 (CRI 001)</span>
<span class="co">#&gt; 7  Ope  Publishing       White    11/03/1964 P.4 (CRI 001)</span>
<span class="co">#&gt; 8  Ope Procurement       Black    11/10/1985 P.1 (CRI 001)</span>

<span class="co"># 1 stage linkage </span>
  <span class="co"># stage 1 - name AND ((department)  AND (hair_colour) AND (dd-mm OR dd-yyyy OR mm-yyyy))</span>
<span class="no">Opes</span>$<span class="no">pids_d</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/links.html">links</a></span>(<span class="kw">criteria</span> <span class="kw">=</span> <span class="no">Opes</span>$<span class="no">name</span>,
                     <span class="kw">sub_criteria</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">cr1</span> <span class="kw">=</span> <span class="fu"><a href="../reference/sub_criteria.html">sub_criteria</a></span>(<span class="no">Opes</span>$<span class="no">department</span>),
                                         <span class="kw">cr1</span> <span class="kw">=</span> <span class="fu"><a href="../reference/sub_criteria.html">sub_criteria</a></span>(<span class="no">Opes</span>$<span class="no">hair_colour</span>),
                                         <span class="kw">cr1</span> <span class="kw">=</span> <span class="fu"><a href="../reference/sub_criteria.html">sub_criteria</a></span>(<span class="no">Opes</span>$<span class="no">db_pt1</span>, <span class="no">Opes</span>$<span class="no">db_pt2</span>, <span class="no">Opes</span>$<span class="no">db_pt3</span>)),
                            <span class="kw">display</span> <span class="kw">=</span> <span class="st">"none"</span>)

<span class="no">Opes</span>[<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"name"</span>,<span class="st">"department"</span>,<span class="st">"hair_colour"</span>,<span class="st">"date_of_birth"</span>,<span class="st">"pids_d"</span>)]
<span class="co">#&gt;   name  department hair_colour date_of_birth        pids_d</span>
<span class="co">#&gt; 1  Ope Procurement       Brown    23/03/1986 P.1 (CRI 001)</span>
<span class="co">#&gt; 2  Ope    Security       Brown    23/03/1986 P.2 (CRI 001)</span>
<span class="co">#&gt; 3  Ope    Security       Brown    23/03/1968 P.2 (CRI 001)</span>
<span class="co">#&gt; 4  Ope  Publishing       Green    01/02/1985 P.4 (CRI 001)</span>
<span class="co">#&gt; 5  Ope  Publishing        Teal    02/01/1985 P.4 (CRI 001)</span>
<span class="co">#&gt; 6  Ope  Publishing        Grey    11/03/1964 P.4 (CRI 001)</span>
<span class="co">#&gt; 7  Ope  Publishing       White    11/03/1964 P.4 (CRI 001)</span>
<span class="co">#&gt; 8  Ope Procurement       Black    11/10/1985 P.1 (CRI 001)</span></pre></body></html></div>
</div>
<div id="multistage-linkage" class="section level2">
<h2 class="hasAnchor">
<a href="#multistage-linkage" class="anchor"></a>Multistage linkage</h2>
<p><a id="record_expansion"></a></p>
<div id="group-expansion" class="section level3">
<h3 class="hasAnchor">
<a href="#group-expansion" class="anchor"></a>Group expansion</h3>
<p>By default, matches at different stages are linked together. The more stages (<code>criteria</code>) there are in an instance of <code><a href="../reference/links.html">links()</a></code>, the larger a record group becomes. Priority is always given to matches that occurred at earlier stages. As a result, it’s important that <code>criteria</code> are listed in decreasing order of certainty. You can disable the link between stages by changing the <code>expand</code> argument to <code>FALSE</code>. See a simple example below.</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">Opes</span>); <span class="no">Opes</span>
<span class="co">#&gt;   rd_id name  department hair_colour date_of_birth db_pt1  db_pt2  db_pt3</span>
<span class="co">#&gt; 1     1  Ope Procurement       Brown    23/03/1986  23/03 23/1986 03/1986</span>
<span class="co">#&gt; 2     2  Ope    Security       Brown    23/03/1986  23/03 23/1986 03/1986</span>
<span class="co">#&gt; 3     3  Ope    Security       Brown    23/03/1968  23/03 23/1968 03/1968</span>
<span class="co">#&gt; 4     4  Ope  Publishing       Green    01/02/1985  01/02 01/1985 02/1985</span>
<span class="co">#&gt; 5     5  Ope  Publishing        Teal    02/01/1985  02/01 02/1985 01/1985</span>
<span class="co">#&gt; 6     6  Ope  Publishing        Grey    11/03/1964  11/03 11/1964 03/1964</span>
<span class="co">#&gt; 7     7  Ope  Publishing       White    11/03/1964  11/03 11/1964 03/1964</span>
<span class="co">#&gt; 8     8  Ope Procurement       Black    11/10/1985  11/10 11/1985 10/1985</span>

<span class="co"># 2 stage linkage</span>
  <span class="co"># stage 1 - link "Opes" in departments that start with the letter "P" THEN </span>
  <span class="co"># stage 2 - bridge these to "Opes" whose hair colour starts with the letter "B"</span>
<span class="no">dept_func</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">x</span>, <span class="no">y</span>) <span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span>(<span class="no">x</span>, <span class="fl">1</span>, <span class="fl">1</span>) <span class="kw">==</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span>(<span class="no">y</span>, <span class="fl">1</span>, <span class="fl">1</span>) <span class="kw">&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span>(<span class="no">y</span>, <span class="fl">1</span>, <span class="fl">1</span>) <span class="kw">==</span> <span class="st">"P"</span>
<span class="no">hair_func</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">x</span>, <span class="no">y</span>) <span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span>(<span class="no">x</span>, <span class="fl">1</span>, <span class="fl">1</span>) <span class="kw">==</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span>(<span class="no">y</span>, <span class="fl">1</span>, <span class="fl">1</span>) <span class="kw">&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span>(<span class="no">y</span>, <span class="fl">1</span>, <span class="fl">1</span>) <span class="kw">==</span> <span class="st">"B"</span>

<span class="no">Opes</span>$<span class="no">p_exp_a</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/links.html">links</a></span>(<span class="kw">criteria</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="no">Opes</span>$<span class="no">name</span>, <span class="no">Opes</span>$<span class="no">name</span>),
                     <span class="kw">sub_criteria</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
                       <span class="kw">cr1</span> <span class="kw">=</span> <span class="fu"><a href="../reference/sub_criteria.html">sub_criteria</a></span>(<span class="no">Opes</span>$<span class="no">department</span>, <span class="kw">match_funcs</span> <span class="kw">=</span> <span class="no">dept_func</span>),
                       <span class="kw">cr2</span> <span class="kw">=</span> <span class="fu"><a href="../reference/sub_criteria.html">sub_criteria</a></span>(<span class="no">Opes</span>$<span class="no">hair_colour</span>, <span class="kw">match_funcs</span> <span class="kw">=</span> <span class="no">hair_func</span>)),
                     <span class="kw">display</span> <span class="kw">=</span> <span class="st">"none"</span>)

<span class="co"># 2 stage linkage</span>
  <span class="co"># stage 1 - link "Opes" in departments that start with the letter "P" THEN </span>
  <span class="co"># stage 2 - link "Opes" whose hair colour starts with the letter "B"</span>
<span class="no">Opes</span>$<span class="no">p_nexp_a</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/links.html">links</a></span>(<span class="kw">criteria</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="no">Opes</span>$<span class="no">name</span>, <span class="no">Opes</span>$<span class="no">name</span>),
                     <span class="kw">sub_criteria</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
                       <span class="kw">cr1</span> <span class="kw">=</span> <span class="fu"><a href="../reference/sub_criteria.html">sub_criteria</a></span>(<span class="no">Opes</span>$<span class="no">department</span>, <span class="kw">match_funcs</span> <span class="kw">=</span> <span class="no">dept_func</span>),
                       <span class="kw">cr2</span> <span class="kw">=</span> <span class="fu"><a href="../reference/sub_criteria.html">sub_criteria</a></span>(<span class="no">Opes</span>$<span class="no">hair_colour</span>, <span class="kw">match_funcs</span> <span class="kw">=</span> <span class="no">hair_func</span>)),
                     <span class="kw">expand</span> <span class="kw">=</span> <span class="no">F</span>,
                     <span class="kw">display</span> <span class="kw">=</span> <span class="st">"none"</span>)

<span class="no">Opes</span>[<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"name"</span>,<span class="st">"department"</span>,<span class="st">"hair_colour"</span>, <span class="st">"p_exp_a"</span>, <span class="st">"p_nexp_a"</span>)]
<span class="co">#&gt;   name  department hair_colour       p_exp_a      p_nexp_a</span>
<span class="co">#&gt; 1  Ope Procurement       Brown P.1 (CRI 001) P.1 (CRI 001)</span>
<span class="co">#&gt; 2  Ope    Security       Brown P.1 (CRI 002) P.2 (No hits)</span>
<span class="co">#&gt; 3  Ope    Security       Brown P.1 (CRI 002) P.3 (No hits)</span>
<span class="co">#&gt; 4  Ope  Publishing       Green P.1 (CRI 001) P.1 (CRI 001)</span>
<span class="co">#&gt; 5  Ope  Publishing        Teal P.1 (CRI 001) P.1 (CRI 001)</span>
<span class="co">#&gt; 6  Ope  Publishing        Grey P.1 (CRI 001) P.1 (CRI 001)</span>
<span class="co">#&gt; 7  Ope  Publishing       White P.1 (CRI 001) P.1 (CRI 001)</span>
<span class="co">#&gt; 8  Ope Procurement       Black P.1 (CRI 001) P.1 (CRI 001)</span></pre></body></html></div>
<p>Note that changing <code>expand</code> to <code>TRUE</code> is not the same as reversing the relevance of your matching conditions. See below.</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="co"># The same as `p_exp_a` </span>
<span class="no">Opes</span>$<span class="no">p_exp_b</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/links.html">links</a></span>(<span class="kw">criteria</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="no">Opes</span>$<span class="no">name</span>, <span class="no">Opes</span>$<span class="no">name</span>),
                     <span class="kw">sub_criteria</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
                       <span class="kw">cr2</span> <span class="kw">=</span> <span class="fu"><a href="../reference/sub_criteria.html">sub_criteria</a></span>(<span class="no">Opes</span>$<span class="no">department</span>, <span class="kw">match_funcs</span> <span class="kw">=</span> <span class="no">dept_func</span>),
                       <span class="kw">cr1</span> <span class="kw">=</span> <span class="fu"><a href="../reference/sub_criteria.html">sub_criteria</a></span>(<span class="no">Opes</span>$<span class="no">hair_colour</span>, <span class="kw">match_funcs</span> <span class="kw">=</span> <span class="no">hair_func</span>)),
                     <span class="kw">display</span> <span class="kw">=</span> <span class="st">"none"</span>)

<span class="co"># Not the same as `p_nexp_a`</span>
<span class="no">Opes</span>$<span class="no">p_nexp_b</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/links.html">links</a></span>(<span class="kw">criteria</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="no">Opes</span>$<span class="no">name</span>, <span class="no">Opes</span>$<span class="no">name</span>),
                     <span class="kw">sub_criteria</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
                       <span class="kw">cr2</span> <span class="kw">=</span> <span class="fu"><a href="../reference/sub_criteria.html">sub_criteria</a></span>(<span class="no">Opes</span>$<span class="no">department</span>, <span class="kw">match_funcs</span> <span class="kw">=</span> <span class="no">dept_func</span>),
                       <span class="kw">cr1</span> <span class="kw">=</span> <span class="fu"><a href="../reference/sub_criteria.html">sub_criteria</a></span>(<span class="no">Opes</span>$<span class="no">hair_colour</span>, <span class="kw">match_funcs</span> <span class="kw">=</span> <span class="no">hair_func</span>)),
                     <span class="kw">expand</span> <span class="kw">=</span> <span class="no">F</span>,
                     <span class="kw">display</span> <span class="kw">=</span> <span class="st">"none"</span>)

<span class="no">Opes</span>[<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"name"</span>,<span class="st">"department"</span>,<span class="st">"hair_colour"</span>, <span class="st">"p_exp_a"</span>, <span class="st">"p_exp_b"</span>, <span class="st">"p_nexp_a"</span>, <span class="st">"p_nexp_b"</span>)]
<span class="co">#&gt;   name  department hair_colour       p_exp_a       p_exp_b      p_nexp_a</span>
<span class="co">#&gt; 1  Ope Procurement       Brown P.1 (CRI 001) P.1 (CRI 001) P.1 (CRI 001)</span>
<span class="co">#&gt; 2  Ope    Security       Brown P.1 (CRI 002) P.1 (CRI 001) P.2 (No hits)</span>
<span class="co">#&gt; 3  Ope    Security       Brown P.1 (CRI 002) P.1 (CRI 001) P.3 (No hits)</span>
<span class="co">#&gt; 4  Ope  Publishing       Green P.1 (CRI 001) P.1 (CRI 002) P.1 (CRI 001)</span>
<span class="co">#&gt; 5  Ope  Publishing        Teal P.1 (CRI 001) P.1 (CRI 002) P.1 (CRI 001)</span>
<span class="co">#&gt; 6  Ope  Publishing        Grey P.1 (CRI 001) P.1 (CRI 002) P.1 (CRI 001)</span>
<span class="co">#&gt; 7  Ope  Publishing       White P.1 (CRI 001) P.1 (CRI 002) P.1 (CRI 001)</span>
<span class="co">#&gt; 8  Ope Procurement       Black P.1 (CRI 001) P.1 (CRI 001) P.1 (CRI 001)</span>
<span class="co">#&gt;        p_nexp_b</span>
<span class="co">#&gt; 1 P.1 (CRI 001)</span>
<span class="co">#&gt; 2 P.1 (CRI 001)</span>
<span class="co">#&gt; 3 P.1 (CRI 001)</span>
<span class="co">#&gt; 4 P.4 (CRI 002)</span>
<span class="co">#&gt; 5 P.4 (CRI 002)</span>
<span class="co">#&gt; 6 P.4 (CRI 002)</span>
<span class="co">#&gt; 7 P.4 (CRI 002)</span>
<span class="co">#&gt; 8 P.1 (CRI 001)</span></pre></body></html></div>
<p><strong><em>Example 1 of group expansion</em></strong></p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">patient_list_2</span>); <span class="no">patient_list_2</span>
<span class="co">#&gt;   rd_id forename     surname    sex</span>
<span class="co">#&gt; 1     1     &lt;NA&gt;   Jefferson   Male</span>
<span class="co">#&gt; 2     2     &lt;NA&gt;   Jefferson Female</span>
<span class="co">#&gt; 3     3     Tomi       Abdul   Male</span>
<span class="co">#&gt; 4     4     Tomi Abdulkareem Female</span>
<span class="co">#&gt; 5     5     &lt;NA&gt;        &lt;NA&gt;   Male</span>

<span class="no">patient_list_2</span>$<span class="no">pids_a</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/links.html">links</a></span>(
  <span class="kw">sn</span> <span class="kw">=</span> <span class="no">patient_list_2</span>$<span class="no">rd_id</span>,
  <span class="kw">criteria</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="no">patient_list_2</span>$<span class="no">forename</span>,
                  <span class="no">patient_list_2</span>$<span class="no">surname</span>,
                  <span class="no">patient_list_2</span>$<span class="no">sex</span>),
  <span class="kw">display</span> <span class="kw">=</span> <span class="st">"none"</span>)

<span class="no">patient_list_2</span>
<span class="co">#&gt;   rd_id forename     surname    sex        pids_a</span>
<span class="co">#&gt; 1     1     &lt;NA&gt;   Jefferson   Male P.1 (CRI 002)</span>
<span class="co">#&gt; 2     2     &lt;NA&gt;   Jefferson Female P.1 (CRI 002)</span>
<span class="co">#&gt; 3     3     Tomi       Abdul   Male P.3 (CRI 001)</span>
<span class="co">#&gt; 4     4     Tomi Abdulkareem Female P.3 (CRI 001)</span>
<span class="co">#&gt; 5     5     &lt;NA&gt;        &lt;NA&gt;   Male P.3 (CRI 003)</span></pre></body></html></div>
<p><img src="links_files/figure-html/unnamed-chunk-14-1.png" width="816"></p>
<p><img src="links_files/figure-html/unnamed-chunk-15-1.png" width="816"></p>
<p><strong><em>Example 2 of group expansion</em></strong></p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="no">df</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(
  <span class="kw">forename</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"John"</span>, <span class="st">"John"</span>, <span class="st">"Jon"</span>,
               <span class="fl">NA_character_</span>, <span class="st">"Mary"</span>, <span class="st">"Mary"</span>,
               <span class="st">"Mariam"</span>, <span class="st">"John"</span>, <span class="st">"Henry"</span>,
               <span class="st">"Obinna"</span>, <span class="st">"Tomi"</span>),
  <span class="kw">surname</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Swan"</span>, <span class="st">"Swanley"</span>, <span class="st">"Swanley"</span>,
              <span class="fl">NA_character_</span>, <span class="st">"Jane"</span>, <span class="st">"Jan"</span>,
              <span class="st">"Janet"</span>, <span class="st">"Swan"</span>, <span class="st">"Henderson"</span>,
              <span class="st">"Nelson"</span>, <span class="st">"Abdulkareem"</span>),
  <span class="kw">age</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">12</span>, <span class="fl">11</span>, <span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">6</span>, <span class="fl">12</span>, <span class="fl">30</span>, <span class="fl">31</span>, <span class="fl">2500</span>)
)

<span class="no">df</span>$<span class="no">pids_a</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/links.html">links</a></span>(<span class="kw">criteria</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="no">df</span>$<span class="no">forename</span>, <span class="no">df</span>$<span class="no">surname</span>, <span class="no">df</span>$<span class="no">age</span>), <span class="kw">display</span> <span class="kw">=</span> <span class="st">"none"</span>)

<span class="no">df</span>
<span class="co">#&gt;    forename     surname  age         pids_a</span>
<span class="co">#&gt; 1      John        Swan   12 P.01 (CRI 001)</span>
<span class="co">#&gt; 2      John     Swanley   11 P.01 (CRI 001)</span>
<span class="co">#&gt; 3       Jon     Swanley   10 P.01 (CRI 002)</span>
<span class="co">#&gt; 4      &lt;NA&gt;        &lt;NA&gt;   10 P.01 (CRI 003)</span>
<span class="co">#&gt; 5      Mary        Jane    5 P.05 (CRI 001)</span>
<span class="co">#&gt; 6      Mary         Jan    6 P.05 (CRI 001)</span>
<span class="co">#&gt; 7    Mariam       Janet    6 P.05 (CRI 003)</span>
<span class="co">#&gt; 8      John        Swan   12 P.01 (CRI 001)</span>
<span class="co">#&gt; 9     Henry   Henderson   30 P.09 (No hits)</span>
<span class="co">#&gt; 10   Obinna      Nelson   31 P.10 (No hits)</span>
<span class="co">#&gt; 11     Tomi Abdulkareem 2500 P.11 (No hits)</span></pre></body></html></div>
<p><img src="links_files/figure-html/unnamed-chunk-17-1.png" width="816"></p>
<p><img src="links_files/figure-html/unnamed-chunk-18-1.png" width="816"></p>
</div>
<div id="group-shrinkage" class="section level3">
<h3 class="hasAnchor">
<a href="#group-shrinkage" class="anchor"></a>Group shrinkage</h3>
<p>You can also specify the opposite behaviour. Where a record group becomes smaller with each subsequent stage. If there is no <code>sub_criteria</code>, the easiest way of doing this is to concatenate the attributes in each stage. See the example below.</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">Opes</span>); <span class="no">Opes</span>
<span class="co">#&gt;   rd_id name  department hair_colour date_of_birth db_pt1  db_pt2  db_pt3</span>
<span class="co">#&gt; 1     1  Ope Procurement       Brown    23/03/1986  23/03 23/1986 03/1986</span>
<span class="co">#&gt; 2     2  Ope    Security       Brown    23/03/1986  23/03 23/1986 03/1986</span>
<span class="co">#&gt; 3     3  Ope    Security       Brown    23/03/1968  23/03 23/1968 03/1968</span>
<span class="co">#&gt; 4     4  Ope  Publishing       Green    01/02/1985  01/02 01/1985 02/1985</span>
<span class="co">#&gt; 5     5  Ope  Publishing        Teal    02/01/1985  02/01 02/1985 01/1985</span>
<span class="co">#&gt; 6     6  Ope  Publishing        Grey    11/03/1964  11/03 11/1964 03/1964</span>
<span class="co">#&gt; 7     7  Ope  Publishing       White    11/03/1964  11/03 11/1964 03/1964</span>
<span class="co">#&gt; 8     8  Ope Procurement       Black    11/10/1985  11/10 11/1985 10/1985</span>

<span class="co"># 1 stage linkage</span>
  <span class="co"># stage 1 - link "Opes" that are in the same department AND have the same day and month of birth </span>
<span class="no">Opes</span>$<span class="no">cri</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="no">Opes</span>$<span class="no">name</span>, <span class="no">Opes</span>$<span class="no">department</span>, <span class="no">Opes</span>$<span class="no">db_pt1</span>, <span class="kw">sep</span> <span class="kw">=</span> <span class="st">" "</span>)
<span class="no">Opes</span>$<span class="no">p_shk_c</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/links.html">links</a></span>(<span class="kw">criteria</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="no">Opes</span>$<span class="no">cri</span>),
                     <span class="kw">display</span> <span class="kw">=</span> <span class="st">"none"</span>)

<span class="no">Opes</span>[<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"name"</span>,<span class="st">"department"</span>,<span class="st">"db_pt3"</span>, <span class="st">"p_shk_c"</span>)]
<span class="co">#&gt;   name  department  db_pt3       p_shk_c</span>
<span class="co">#&gt; 1  Ope Procurement 03/1986 P.1 (No hits)</span>
<span class="co">#&gt; 2  Ope    Security 03/1986 P.2 (CRI 001)</span>
<span class="co">#&gt; 3  Ope    Security 03/1968 P.2 (CRI 001)</span>
<span class="co">#&gt; 4  Ope  Publishing 02/1985 P.4 (No hits)</span>
<span class="co">#&gt; 5  Ope  Publishing 01/1985 P.5 (No hits)</span>
<span class="co">#&gt; 6  Ope  Publishing 03/1964 P.6 (CRI 001)</span>
<span class="co">#&gt; 7  Ope  Publishing 03/1964 P.6 (CRI 001)</span>
<span class="co">#&gt; 8  Ope Procurement 10/1985 P.8 (No hits)</span></pre></body></html></div>
<p>If there’s a <code>sub_criteria</code>, you’ll need to use the <code>shrink</code> argument. See the example below. The same analysis is repeated using <code>sub_criteria</code>.</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="co"># 3 stage linkage</span>
  <span class="co"># stage 1 - link "Opes" that have the same name, THEN WITHIN THESE</span>
  <span class="co"># stage 2 - link "Opes" that are in the same department, THEN WITHIN THESE</span>
  <span class="co"># stage 3 - link "Opes" have the same day and month of birth </span>
<span class="no">Opes</span>$<span class="no">p_shk_d</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/links.html">links</a></span>(<span class="kw">criteria</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="no">Opes</span>$<span class="no">name</span>, <span class="no">Opes</span>$<span class="no">department</span>, <span class="no">Opes</span>$<span class="no">db_pt1</span>),
                      <span class="kw">sub_criteria</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
                        <span class="kw">cr1</span> <span class="kw">=</span> <span class="fu"><a href="../reference/sub_criteria.html">sub_criteria</a></span>(<span class="st">"place_holder"</span>, <span class="kw">match_funcs</span> <span class="kw">=</span> <span class="kw pkg">diyar</span><span class="kw ns">::</span><span class="no"><a href="../reference/predefined_tests.html">exact_match</a></span>),
                        <span class="kw">cr2</span> <span class="kw">=</span> <span class="fu"><a href="../reference/sub_criteria.html">sub_criteria</a></span>(<span class="st">"place_holder"</span>, <span class="kw">match_funcs</span> <span class="kw">=</span> <span class="kw pkg">diyar</span><span class="kw ns">::</span><span class="no"><a href="../reference/predefined_tests.html">exact_match</a></span>),
                        <span class="kw">cr3</span> <span class="kw">=</span> <span class="fu"><a href="../reference/sub_criteria.html">sub_criteria</a></span>(<span class="st">"place_holder"</span>, <span class="kw">match_funcs</span> <span class="kw">=</span> <span class="kw pkg">diyar</span><span class="kw ns">::</span><span class="no"><a href="../reference/predefined_tests.html">exact_match</a></span>)
                      ),
                      <span class="kw">shrink</span> <span class="kw">=</span> <span class="no">T</span>,
                     <span class="kw">display</span> <span class="kw">=</span> <span class="st">"none"</span>)

<span class="no">Opes</span>[<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"name"</span>,<span class="st">"department"</span>,<span class="st">"db_pt3"</span>, <span class="st">"p_shk_c"</span>, <span class="st">"p_shk_d"</span>)]
<span class="co">#&gt;   name  department  db_pt3       p_shk_c       p_shk_d</span>
<span class="co">#&gt; 1  Ope Procurement 03/1986 P.1 (No hits) P.1 (CRI 002)</span>
<span class="co">#&gt; 2  Ope    Security 03/1986 P.2 (CRI 001) P.2 (CRI 003)</span>
<span class="co">#&gt; 3  Ope    Security 03/1968 P.2 (CRI 001) P.2 (CRI 003)</span>
<span class="co">#&gt; 4  Ope  Publishing 02/1985 P.4 (No hits) P.4 (CRI 002)</span>
<span class="co">#&gt; 5  Ope  Publishing 01/1985 P.5 (No hits) P.4 (CRI 002)</span>
<span class="co">#&gt; 6  Ope  Publishing 03/1964 P.6 (CRI 001) P.6 (CRI 003)</span>
<span class="co">#&gt; 7  Ope  Publishing 03/1964 P.6 (CRI 001) P.6 (CRI 003)</span>
<span class="co">#&gt; 8  Ope Procurement 10/1985 P.8 (No hits) P.1 (CRI 002)</span></pre></body></html></div>
<p>Although <code>p_shk_c</code> and <code>p_shk_d</code> are identical, the <code>pid_cri</code> slot for both are different. This reflects the different ways they were created. <code>p_shk_d</code> is the equivalent of three compounding (using <code>strata</code>) instances of <code><a href="../reference/links.html">links()</a></code>. See below.</p>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="co"># 1 stage linkage</span>
  <span class="co"># stage 1 - link "Opes" that have the same name</span>
<span class="no">Opes</span>$<span class="no">p_shk_e1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/links.html">links</a></span>(<span class="kw">criteria</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="no">Opes</span>$<span class="no">name</span>),
                      <span class="kw">sub_criteria</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
                        <span class="kw">cr1</span> <span class="kw">=</span> <span class="fu"><a href="../reference/sub_criteria.html">sub_criteria</a></span>(<span class="st">"place_holder"</span>, <span class="kw">match_funcs</span> <span class="kw">=</span> <span class="kw pkg">diyar</span><span class="kw ns">::</span><span class="no"><a href="../reference/predefined_tests.html">exact_match</a></span>)),
                      <span class="kw">shrink</span> <span class="kw">=</span> <span class="no">T</span>,
                     <span class="kw">display</span> <span class="kw">=</span> <span class="st">"none"</span>)

<span class="co"># Another attempt is made always made at the next for records with no links </span>
<span class="no">Opes</span>$<span class="no">e1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="no">Opes</span>$<span class="no">p_shk_e1</span>@<span class="kw">pid_cri</span> <span class="kw">==</span> <span class="fl">0</span>, <span class="st">"No Hits"</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="no">Opes</span>$<span class="no">p_shk_e1</span>))

<span class="co"># 1 stage linkage</span>
  <span class="co"># stage 1 - link "Opes" that are in the same department</span>
<span class="no">Opes</span>$<span class="no">p_shk_e2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/links.html">links</a></span>(<span class="kw">criteria</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="no">Opes</span>$<span class="no">department</span>),
                      <span class="kw">strata</span> <span class="kw">=</span> <span class="no">Opes</span>$<span class="no">e1</span>,
                       <span class="kw">sub_criteria</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
                        <span class="kw">cr1</span> <span class="kw">=</span> <span class="fu"><a href="../reference/sub_criteria.html">sub_criteria</a></span>(<span class="st">"place_holder"</span>, <span class="kw">match_funcs</span> <span class="kw">=</span> <span class="kw pkg">diyar</span><span class="kw ns">::</span><span class="no"><a href="../reference/predefined_tests.html">exact_match</a></span>)),
                      <span class="kw">shrink</span> <span class="kw">=</span> <span class="no">T</span>,
                     <span class="kw">display</span> <span class="kw">=</span> <span class="st">"none"</span>)

<span class="co"># Another attempt is made always made at the next for records with no links</span>
<span class="no">Opes</span>$<span class="no">e2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="no">Opes</span>$<span class="no">p_shk_e1</span>@<span class="kw">pid_cri</span> <span class="kw">==</span> <span class="fl">0</span>, <span class="st">"No Hits"</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="no">Opes</span>$<span class="no">p_shk_e1</span>))

<span class="co"># 1 stage linkage</span>
  <span class="co"># stage 3 - link "Opes" have the same day and month of birth </span>
<span class="no">Opes</span>$<span class="no">p_shk_e3</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/links.html">links</a></span>(<span class="kw">criteria</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="no">Opes</span>$<span class="no">db_pt1</span>),
                      <span class="kw">strata</span> <span class="kw">=</span> <span class="no">Opes</span>$<span class="no">e2</span>,
                       <span class="kw">sub_criteria</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
                        <span class="kw">cr1</span> <span class="kw">=</span> <span class="fu"><a href="../reference/sub_criteria.html">sub_criteria</a></span>(<span class="st">"place_holder"</span>, <span class="kw">match_funcs</span> <span class="kw">=</span> <span class="kw pkg">diyar</span><span class="kw ns">::</span><span class="no"><a href="../reference/predefined_tests.html">exact_match</a></span>)),
                      <span class="kw">shrink</span> <span class="kw">=</span> <span class="no">T</span>,
                     <span class="kw">display</span> <span class="kw">=</span> <span class="st">"none"</span>)

<span class="no">Opes</span>[<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"name"</span>,<span class="st">"department"</span>,<span class="st">"db_pt3"</span>, <span class="st">"p_shk_e1"</span>, <span class="st">"p_shk_e2"</span>, <span class="st">"p_shk_e3"</span>, <span class="st">"p_shk_c"</span>, <span class="st">"p_shk_d"</span>)]
<span class="co">#&gt;   name  department  db_pt3      p_shk_e1      p_shk_e2      p_shk_e3</span>
<span class="co">#&gt; 1  Ope Procurement 03/1986 P.1 (CRI 001) P.1 (CRI 001) P.1 (CRI 001)</span>
<span class="co">#&gt; 2  Ope    Security 03/1986 P.1 (CRI 001) P.2 (CRI 001) P.1 (CRI 001)</span>
<span class="co">#&gt; 3  Ope    Security 03/1968 P.1 (CRI 001) P.2 (CRI 001) P.1 (CRI 001)</span>
<span class="co">#&gt; 4  Ope  Publishing 02/1985 P.1 (CRI 001) P.4 (CRI 001) P.4 (No hits)</span>
<span class="co">#&gt; 5  Ope  Publishing 01/1985 P.1 (CRI 001) P.4 (CRI 001) P.5 (No hits)</span>
<span class="co">#&gt; 6  Ope  Publishing 03/1964 P.1 (CRI 001) P.4 (CRI 001) P.6 (CRI 001)</span>
<span class="co">#&gt; 7  Ope  Publishing 03/1964 P.1 (CRI 001) P.4 (CRI 001) P.6 (CRI 001)</span>
<span class="co">#&gt; 8  Ope Procurement 10/1985 P.1 (CRI 001) P.1 (CRI 001) P.8 (No hits)</span>
<span class="co">#&gt;         p_shk_c       p_shk_d</span>
<span class="co">#&gt; 1 P.1 (No hits) P.1 (CRI 002)</span>
<span class="co">#&gt; 2 P.2 (CRI 001) P.2 (CRI 003)</span>
<span class="co">#&gt; 3 P.2 (CRI 001) P.2 (CRI 003)</span>
<span class="co">#&gt; 4 P.4 (No hits) P.4 (CRI 002)</span>
<span class="co">#&gt; 5 P.5 (No hits) P.4 (CRI 002)</span>
<span class="co">#&gt; 6 P.6 (CRI 001) P.6 (CRI 003)</span>
<span class="co">#&gt; 7 P.6 (CRI 001) P.6 (CRI 003)</span>
<span class="co">#&gt; 8 P.8 (No hits) P.1 (CRI 002)</span></pre></body></html></div>
<p>Note that the <code>expand</code> functionality is not always interchangeable with that of <code>shrink</code>. See an example of the difference below.</p>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">Opes</span>); <span class="no">Opes</span>
<span class="co">#&gt;   rd_id name  department hair_colour date_of_birth db_pt1  db_pt2  db_pt3</span>
<span class="co">#&gt; 1     1  Ope Procurement       Brown    23/03/1986  23/03 23/1986 03/1986</span>
<span class="co">#&gt; 2     2  Ope    Security       Brown    23/03/1986  23/03 23/1986 03/1986</span>
<span class="co">#&gt; 3     3  Ope    Security       Brown    23/03/1968  23/03 23/1968 03/1968</span>
<span class="co">#&gt; 4     4  Ope  Publishing       Green    01/02/1985  01/02 01/1985 02/1985</span>
<span class="co">#&gt; 5     5  Ope  Publishing        Teal    02/01/1985  02/01 02/1985 01/1985</span>
<span class="co">#&gt; 6     6  Ope  Publishing        Grey    11/03/1964  11/03 11/1964 03/1964</span>
<span class="co">#&gt; 7     7  Ope  Publishing       White    11/03/1964  11/03 11/1964 03/1964</span>
<span class="co">#&gt; 8     8  Ope Procurement       Black    11/10/1985  11/10 11/1985 10/1985</span>

<span class="no">Opes</span>$<span class="no">p_cmp1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/links.html">links</a></span>(<span class="kw">criteria</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"place_holder"</span>, <span class="st">"place_holder"</span>),
                      <span class="kw">sub_criteria</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
                        <span class="kw">cr1</span> <span class="kw">=</span> <span class="fu"><a href="../reference/sub_criteria.html">sub_criteria</a></span>(<span class="no">Opes</span>$<span class="no">department</span>, <span class="kw">match_funcs</span> <span class="kw">=</span> <span class="no">dept_func</span>),
                        <span class="kw">cr2</span> <span class="kw">=</span> <span class="fu"><a href="../reference/sub_criteria.html">sub_criteria</a></span>(<span class="no">Opes</span>$<span class="no">hair_colour</span>, <span class="kw">match_funcs</span> <span class="kw">=</span> <span class="no">hair_func</span>)),
                     <span class="kw">expand</span> <span class="kw">=</span> <span class="no">T</span>,
                     <span class="kw">shrink</span> <span class="kw">=</span> <span class="no">F</span>,
                     <span class="kw">display</span> <span class="kw">=</span> <span class="st">"none"</span>)

<span class="no">Opes</span>$<span class="no">p_cmp2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/links.html">links</a></span>(<span class="kw">criteria</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"place_holder"</span>, <span class="st">"place_holder"</span>),
                      <span class="kw">sub_criteria</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
                        <span class="kw">cr1</span> <span class="kw">=</span> <span class="fu"><a href="../reference/sub_criteria.html">sub_criteria</a></span>(<span class="no">Opes</span>$<span class="no">department</span>, <span class="kw">match_funcs</span> <span class="kw">=</span> <span class="no">dept_func</span>),
                        <span class="kw">cr2</span> <span class="kw">=</span> <span class="fu"><a href="../reference/sub_criteria.html">sub_criteria</a></span>(<span class="no">Opes</span>$<span class="no">hair_colour</span>, <span class="kw">match_funcs</span> <span class="kw">=</span> <span class="no">hair_func</span>)),
                     <span class="kw">expand</span> <span class="kw">=</span> <span class="no">F</span>,
                     <span class="kw">shrink</span> <span class="kw">=</span> <span class="no">T</span>,
                     <span class="kw">display</span> <span class="kw">=</span> <span class="st">"none"</span>)

<span class="co"># `p_cmp1` is not the same as `p_cmp2`</span>
<span class="no">Opes</span>[<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"name"</span>, <span class="st">"department"</span>, <span class="st">"hair_colour"</span>, <span class="st">"p_cmp1"</span>, <span class="st">"p_cmp2"</span>)]
<span class="co">#&gt;   name  department hair_colour        p_cmp1        p_cmp2</span>
<span class="co">#&gt; 1  Ope Procurement       Brown P.1 (CRI 001) P.1 (CRI 002)</span>
<span class="co">#&gt; 2  Ope    Security       Brown P.1 (CRI 002) P.2 (CRI 002)</span>
<span class="co">#&gt; 3  Ope    Security       Brown P.1 (CRI 002) P.2 (CRI 002)</span>
<span class="co">#&gt; 4  Ope  Publishing       Green P.1 (CRI 001) P.4 (No hits)</span>
<span class="co">#&gt; 5  Ope  Publishing        Teal P.1 (CRI 001) P.5 (No hits)</span>
<span class="co">#&gt; 6  Ope  Publishing        Grey P.1 (CRI 001) P.6 (No hits)</span>
<span class="co">#&gt; 7  Ope  Publishing       White P.1 (CRI 001) P.7 (No hits)</span>
<span class="co">#&gt; 8  Ope Procurement       Black P.1 (CRI 001) P.1 (CRI 002)</span></pre></body></html></div>
<p><a id="missing_values"></a></p>
</div>
</div>
<div id="handling-missing-values" class="section level2">
<h2 class="hasAnchor">
<a href="#handling-missing-values" class="anchor"></a>Handling missing values</h2>
<p>Records with missing values are excluded from particular stages of the linkage process. If a record has missing values at every stage, it’s assigned to a unique group where it’s the only member.</p>
<p>It’s common for databases to use specific characters or numbers to represent missing or unknown data e.g. <code>N/A</code>, <code>Nil</code>, <code>01/01/1100</code>, <code>111111</code> e.t.c. These pseudo-missing values must need to be re-coded to <code>NA</code>, so that <code><a href="../reference/links.html">links()</a></code> recognises them as missing values. If this is not done, it can lead to a cascade of false matches as seen below.</p>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="no">patient_list_2</span>$<span class="no">forename</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="no">patient_list_2</span>$<span class="no">rd_id</span> <span class="kw">%in%</span> <span class="fl">1</span>:<span class="fl">3</span>, <span class="st">"Nil"</span>, <span class="no">patient_list_2</span>$<span class="no">forename</span>)
<span class="co"># 2 stage linkage</span>
    <span class="co"># Stage 1 - forename</span>
    <span class="co"># Stage 2 - surname</span>

<span class="no">patient_list_2</span>$<span class="no">pids_b</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/links.html">links</a></span>(<span class="kw">criteria</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="no">patient_list_2</span>$<span class="no">forename</span>,
                                               <span class="no">patient_list_2</span>$<span class="no">surname</span>),
                               <span class="kw">display</span> <span class="kw">=</span> <span class="st">"none"</span>)

<span class="no">patient_list_2</span>[<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"forename"</span>,<span class="st">"surname"</span>,<span class="st">"pids_b"</span>)]
<span class="co">#&gt;   forename     surname        pids_b</span>
<span class="co">#&gt; 1      Nil   Jefferson P.1 (CRI 001)</span>
<span class="co">#&gt; 2      Nil   Jefferson P.1 (CRI 001)</span>
<span class="co">#&gt; 3      Nil       Abdul P.1 (CRI 001)</span>
<span class="co">#&gt; 4     Tomi Abdulkareem P.4 (No hits)</span>
<span class="co">#&gt; 5     &lt;NA&gt;        &lt;NA&gt; P.5 (No hits)</span></pre></body></html></div>
<p>In the example above, records 1-3 are assigned to the same record group even though record 3 seems to be a different person. However, changing <code>"Nil"</code> to <code>NA</code> let <code><a href="../reference/links.html">links()</a></code> know that <code>"Nil"</code> is not a valid <code>forename</code>, and it is skipped. See below.</p>
<div class="sourceCode" id="cb17"><html><body><pre class="r"><span class="co"># `NA` as the proxy for missing value</span>
<span class="no">patient_list_2</span>$<span class="no">forename</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="no">patient_list_2</span>$<span class="no">forename</span> <span class="kw">==</span> <span class="st">"Nil"</span>, <span class="fl">NA</span>, <span class="no">patient_list_2</span>$<span class="no">forename</span>)

<span class="no">patient_list_2</span>$<span class="no">pids_d</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/links.html">links</a></span>(<span class="kw">sn</span> <span class="kw">=</span> <span class="no">patient_list_2</span>$<span class="no">rd_id</span>,
                               <span class="kw">criteria</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="no">patient_list_2</span>$<span class="no">forename</span>,
                                               <span class="no">patient_list_2</span>$<span class="no">surname</span>),
                               <span class="kw">display</span> <span class="kw">=</span> <span class="st">"none"</span>)

<span class="no">patient_list_2</span>[<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"forename"</span>,<span class="st">"surname"</span>, <span class="st">"pids_b"</span>, <span class="st">"pids_d"</span>)]
<span class="co">#&gt;   forename     surname        pids_b        pids_d</span>
<span class="co">#&gt; 1     &lt;NA&gt;   Jefferson P.1 (CRI 001) P.1 (CRI 002)</span>
<span class="co">#&gt; 2     &lt;NA&gt;   Jefferson P.1 (CRI 001) P.1 (CRI 002)</span>
<span class="co">#&gt; 3     &lt;NA&gt;       Abdul P.1 (CRI 001) P.3 (No hits)</span>
<span class="co">#&gt; 4     Tomi Abdulkareem P.4 (No hits) P.4 (No hits)</span>
<span class="co">#&gt; 5     &lt;NA&gt;        &lt;NA&gt; P.5 (No hits) P.5 (No hits)</span></pre></body></html></div>
<p><a id="tips"></a></p>
</div>
<div id="tips" class="section level2">
<h2 class="hasAnchor">
<a href="#tips" class="anchor"></a>Tips</h2>
</div>
<div id="criteria-over-sub_criteria" class="section level2">
<h2 class="hasAnchor">
<a href="#criteria-over-sub_criteria" class="anchor"></a><code>criteria</code> over <code>sub_criteria</code>
</h2>
<p><code>sub_criteria</code> are required for user-defined logical tests. However, it takes more time to compare <code>sub_criteria</code> than it does <code>criteria</code>. You can save some time by only using a <code>sub_criteria</code> when the matching conditions can not be specified as a <code>criteria</code>. For example, the logical test <code>lgl_1</code> (above) was supplied as a <code>sub_criteria</code>. <code><a href="../reference/links.html">links()</a></code> will create that group identifier faster, if it’s supplied as a <code>criteria</code>. See below.</p>
<div class="sourceCode" id="cb18"><html><body><pre class="r"><span class="co"># Matching `sex`, and `forename` initials</span>
<span class="no">dbs2</span>
<span class="co">#&gt;   forename surname sex        pids_1        pids_2        pids_3        pids_4</span>
<span class="co">#&gt; 1    James   Green   M P.1 (CRI 001) P.1 (CRI 001) P.5 (CRI 001) P.4 (CRI 001)</span>
<span class="co">#&gt; 2   ESTHER  Kulmar   F P.2 (No hits) P.2 (No hits) P.2 (No hits) P.2 (No hits)</span>
<span class="co">#&gt; 3     &lt;NA&gt;     OBI   F P.3 (No hits) P.3 (No hits) P.3 (No hits) P.3 (No hits)</span>
<span class="co">#&gt; 4    Jamey   Green   M P.1 (CRI 001) P.1 (CRI 001) P.5 (CRI 001) P.4 (CRI 001)</span>
<span class="co">#&gt; 5   Daniel  Kulmar   M P.5 (No hits) P.5 (No hits) P.5 (CRI 001) P.4 (CRI 001)</span>
<span class="co">#&gt; 6    Henry     OBI   M P.6 (No hits) P.1 (CRI 001) P.5 (CRI 001) P.4 (CRI 001)</span>
<span class="no">dbs2</span>$<span class="no">initials</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span>(<span class="no">dbs2</span>$<span class="no">forename</span>, <span class="fl">1</span>, <span class="fl">1</span>)
<span class="no">dbs2</span>$<span class="no">pids_1b</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/links.html">links</a></span>(<span class="kw">criteria</span> <span class="kw">=</span> <span class="no">dbs2</span>$<span class="no">initials</span>,
                     <span class="kw">display</span> <span class="kw">=</span> <span class="st">"none"</span>)

<span class="no">dbs2</span>[<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"forename"</span>, <span class="st">"initials"</span>, <span class="st">"pids_1"</span>, <span class="st">"pids_1b"</span>)]
<span class="co">#&gt;   forename initials        pids_1       pids_1b</span>
<span class="co">#&gt; 1    James        J P.1 (CRI 001) P.1 (CRI 001)</span>
<span class="co">#&gt; 2   ESTHER        E P.2 (No hits) P.2 (No hits)</span>
<span class="co">#&gt; 3     &lt;NA&gt;     &lt;NA&gt; P.3 (No hits) P.3 (No hits)</span>
<span class="co">#&gt; 4    Jamey        J P.1 (CRI 001) P.1 (CRI 001)</span>
<span class="co">#&gt; 5   Daniel        D P.5 (No hits) P.5 (No hits)</span>
<span class="co">#&gt; 6    Henry        H P.6 (No hits) P.6 (No hits)</span></pre></body></html></div>
<p>Similarly, avoid using single-attribute <code>sub_criteria</code> that are paired to the same <code>criteria</code>. Instead, concatenate these together as one <code>criteria</code>. For example, the two implementations below (<code>pids_e</code> and <code>pids_f</code>) will have the same result. But <code>pids_f</code> will take less time.</p>
<div class="sourceCode" id="cb19"><html><body><pre class="r"><span class="co"># 1 stage linkage </span>
  <span class="co"># stage 1 - name AND ((department)  AND (hair_colour) AND (year_of_birth))</span>
<span class="no">Opes</span>$<span class="no">month_of_birth</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span>(<span class="no">Opes</span>$<span class="no">date_of_birth</span>, <span class="fl">4</span>, <span class="fl">5</span>)
<span class="no">Opes</span>$<span class="no">pids_e</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/links.html">links</a></span>(<span class="kw">criteria</span> <span class="kw">=</span> <span class="no">Opes</span>$<span class="no">name</span>,
                     <span class="kw">sub_criteria</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">cr1</span> <span class="kw">=</span> <span class="fu"><a href="../reference/sub_criteria.html">sub_criteria</a></span>(<span class="no">Opes</span>$<span class="no">department</span>),
                                         <span class="kw">cr1</span> <span class="kw">=</span> <span class="fu"><a href="../reference/sub_criteria.html">sub_criteria</a></span>(<span class="no">Opes</span>$<span class="no">hair_colour</span>),
                                         <span class="kw">cr1</span> <span class="kw">=</span> <span class="fu"><a href="../reference/sub_criteria.html">sub_criteria</a></span>(<span class="no">Opes</span>$<span class="no">month_of_birth</span>)),
                            <span class="kw">display</span> <span class="kw">=</span> <span class="st">"none"</span>)

<span class="no">Opes</span>$<span class="no">cri</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="no">Opes</span>$<span class="no">name</span>, <span class="no">Opes</span>$<span class="no">month_of_birth</span>, <span class="no">Opes</span>$<span class="no">department</span>, <span class="no">Opes</span>$<span class="no">hair_colour</span>, <span class="kw">sep</span><span class="kw">=</span><span class="st">"-"</span>)

<span class="co"># 1 stage linkage </span>
  <span class="co"># stage 1 - name AND department AND hair_colour AND date_of_birth</span>
<span class="no">Opes</span>$<span class="no">pids_f</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/links.html">links</a></span>(<span class="kw">criteria</span> <span class="kw">=</span> <span class="no">Opes</span>$<span class="no">cri</span>,  <span class="kw">display</span> <span class="kw">=</span> <span class="st">"none"</span>)

<span class="no">Opes</span>[<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"name"</span>,<span class="st">"department"</span>,<span class="st">"hair_colour"</span>,<span class="st">"month_of_birth"</span>,<span class="st">"pids_e"</span>,<span class="st">"pids_f"</span>)]
<span class="co">#&gt;   name  department hair_colour month_of_birth        pids_e        pids_f</span>
<span class="co">#&gt; 1  Ope Procurement       Brown             03 P.1 (CRI 001) P.1 (No hits)</span>
<span class="co">#&gt; 2  Ope    Security       Brown             03 P.2 (CRI 001) P.2 (CRI 001)</span>
<span class="co">#&gt; 3  Ope    Security       Brown             03 P.2 (CRI 001) P.2 (CRI 001)</span>
<span class="co">#&gt; 4  Ope  Publishing       Green             02 P.4 (CRI 001) P.4 (No hits)</span>
<span class="co">#&gt; 5  Ope  Publishing        Teal             01 P.4 (CRI 001) P.5 (No hits)</span>
<span class="co">#&gt; 6  Ope  Publishing        Grey             03 P.4 (CRI 001) P.6 (No hits)</span>
<span class="co">#&gt; 7  Ope  Publishing       White             03 P.4 (CRI 001) P.7 (No hits)</span>
<span class="co">#&gt; 8  Ope Procurement       Black             10 P.1 (CRI 001) P.8 (No hits)</span></pre></body></html></div>
<p>This time difference could become more noticeable with larger datasets.</p>
</div>
<div id="convenience-vs-efficiency" class="section level2">
<h2 class="hasAnchor">
<a href="#convenience-vs-efficiency" class="anchor"></a>Convenience vs efficiency</h2>
<p><code><a href="../reference/links.html">links()</a></code> is a convenient tool for routine data linkage. But it’s more useful in handling complex matching conditions, missing data and multistage linkage. The more complex the scenario, the more likely its convenience outweighs the complexity of scripting them. Simple matching conditions or one-stage linkages are possible with <code><a href="../reference/links.html">links()</a></code>. But this takes slightly more time than base <code>R</code> alternatives. See the example below.</p>
<div class="sourceCode" id="cb20"><html><body><pre class="r"><span class="no">Opes</span>[<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"department"</span>)]
<span class="co">#&gt;    department</span>
<span class="co">#&gt; 1 Procurement</span>
<span class="co">#&gt; 2    Security</span>
<span class="co">#&gt; 3    Security</span>
<span class="co">#&gt; 4  Publishing</span>
<span class="co">#&gt; 5  Publishing</span>
<span class="co">#&gt; 6  Publishing</span>
<span class="co">#&gt; 7  Publishing</span>
<span class="co">#&gt; 8 Procurement</span>

<span class="no">Opes</span>$<span class="no">links_a</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/links.html">links</a></span>(<span class="no">Opes</span>$<span class="no">department</span>, <span class="kw">display</span> <span class="kw">=</span> <span class="st">"none"</span>)

<span class="no">Opes</span>$<span class="no">links_b</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/match.html">match</a></span>(<span class="no">Opes</span>$<span class="no">department</span>, <span class="no">Opes</span>$<span class="no">department</span>[!<span class="fu"><a href="https://rdrr.io/r/base/duplicated.html">duplicated</a></span>(<span class="no">Opes</span>$<span class="no">department</span>)])

<span class="no">Opes</span>[<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"department"</span>, <span class="st">"links_a"</span>, <span class="st">"links_b"</span>)]
<span class="co">#&gt;    department       links_a links_b</span>
<span class="co">#&gt; 1 Procurement P.1 (CRI 001)       1</span>
<span class="co">#&gt; 2    Security P.2 (CRI 001)       2</span>
<span class="co">#&gt; 3    Security P.2 (CRI 001)       2</span>
<span class="co">#&gt; 4  Publishing P.4 (CRI 001)       3</span>
<span class="co">#&gt; 5  Publishing P.4 (CRI 001)       3</span>
<span class="co">#&gt; 6  Publishing P.4 (CRI 001)       3</span>
<span class="co">#&gt; 7  Publishing P.4 (CRI 001)       3</span>
<span class="co">#&gt; 8 Procurement P.1 (CRI 001)       1</span></pre></body></html></div>
<p>This time difference could become more noticeable with larger datasets.</p>
</div>
</div>
<div id="conclusion" class="section level1">
<h1 class="hasAnchor">
<a href="#conclusion" class="anchor"></a>Conclusion</h1>
<p>As a general rule, the more unique the <code>criteria</code>, the earlier it should be used in the linkage process. Always use a reasonable order of relevance for each dataset. Not too strict and not too lax. <code><a href="../reference/links.html">links()</a></code> will try to reduce false mismatches due to random data entry errors or missing values. Always balance the use of matching attributes with their availability and accuracy.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Olisaeloka Nsonwu.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
