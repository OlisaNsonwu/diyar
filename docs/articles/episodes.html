<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to epidemiological case definitions with diyar • diyar</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to epidemiological case definitions with diyar">
<meta property="og:description" content="diyar">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">diyar</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.5.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/episodes.html">Introduction to epidemiological case definitions with diyar</a>
    </li>
    <li>
      <a href="../articles/links.html">Introduction to record linkage with diyar</a>
    </li>
    <li>
      <a href="../articles/number_line.html">number_line and overlaps</a>
    </li>
    <li>
      <a href="../articles/panes.html">Divvy up events with partitions</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/OlisaNsonwu/diyar/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to epidemiological case definitions
with diyar</h1>
            
            <h4 data-toc-skip class="date">01 November 2023</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/OlisaNsonwu/diyar/blob/HEAD/vignettes/episodes.Rmd" class="external-link"><code>vignettes/episodes.Rmd</code></a></small>
      <div class="hidden name"><code>episodes.Rmd</code></div>

    </div>

    
    
<p>In epidemiological analyses an exact distinction between temporal
events is not always possible. Therefore, static but reasonable cut-offs
are used to distinguish one occurrence of an event from another. This is
an important aspect of most case definitions. For example,
distinguishing repeat or recurrent infections from the first occurrence
of that infection.</p>
<p>This vignette provides a brief introduction to how this is done with
<code><a href="../reference/episodes.html">episodes()</a></code>.</p>
<p>We begin by reviewing <code>event_dt</code> below. This is a sample
dataset of 11 infection events and includes data on the location and
type of infection.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">event_dt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2021-01-01"</span><span class="op">)</span>, to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2021-01-11"</span><span class="op">)</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">event_dt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>date <span class="op">=</span> <span class="va">event_dt</span><span class="op">)</span></span>
<span><span class="va">event_dt</span><span class="op">$</span><span class="va">attr_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BSI"</span>, <span class="st">"UTI"</span>, <span class="st">"RTI"</span>, <span class="st">"RTI"</span>, <span class="st">"BSI"</span>, <span class="st">"BSI"</span>, <span class="st">"BSI"</span>, <span class="st">"RTI"</span>, <span class="st">"RTI"</span>, <span class="st">"BSI"</span>, <span class="st">"RTI"</span><span class="op">)</span></span>
<span><span class="va">event_dt</span><span class="op">$</span><span class="va">attr_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Ward 1"</span>, <span class="st">"Ward 1"</span>, <span class="st">"Ward 3"</span>, <span class="st">"Ward 3"</span>, <span class="st">"Ward 2"</span>, <span class="st">"Ward 2"</span>, </span>
<span>                     <span class="st">"Ward 1"</span>, <span class="st">"Ward 1"</span>, <span class="st">"Ward 3"</span>,<span class="st">"Ward 3"</span>, <span class="st">"Ward 2"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">event_dt</span></span>
<span><span class="co">#&gt;          date attr_1 attr_2</span></span>
<span><span class="co">#&gt; 1  2021-01-01    BSI Ward 1</span></span>
<span><span class="co">#&gt; 2  2021-01-02    UTI Ward 1</span></span>
<span><span class="co">#&gt; 3  2021-01-03    RTI Ward 3</span></span>
<span><span class="co">#&gt; 4  2021-01-04    RTI Ward 3</span></span>
<span><span class="co">#&gt; 5  2021-01-05    BSI Ward 2</span></span>
<span><span class="co">#&gt; 6  2021-01-06    BSI Ward 2</span></span>
<span><span class="co">#&gt; 7  2021-01-07    BSI Ward 1</span></span>
<span><span class="co">#&gt; 8  2021-01-08    RTI Ward 1</span></span>
<span><span class="co">#&gt; 9  2021-01-09    RTI Ward 3</span></span>
<span><span class="co">#&gt; 10 2021-01-10    BSI Ward 3</span></span>
<span><span class="co">#&gt; 11 2021-01-11    RTI Ward 2</span></span></code></pre></div>
<p>The simplest kind of case definitions are those where only one event
is retained making every other event a duplicate <code>(D)</code> of the
index event <code>(C)</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">event_dt</span><span class="op">$</span><span class="va">ep1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/episodes.html">episodes</a></span><span class="op">(</span><span class="va">event_dt</span><span class="op">$</span><span class="va">date</span>, episode_type <span class="op">=</span> <span class="st">"fixed"</span><span class="op">)</span></span>
<span><span class="va">event_dt</span></span>
<span><span class="co">#&gt;          date attr_1 attr_2                              ep1</span></span>
<span><span class="co">#&gt; 1  2021-01-01    BSI Ward 1 E.1 2021-01-01 -&gt; 2021-01-11 (C)</span></span>
<span><span class="co">#&gt; 2  2021-01-02    UTI Ward 1 E.1 2021-01-01 -&gt; 2021-01-11 (D)</span></span>
<span><span class="co">#&gt; 3  2021-01-03    RTI Ward 3 E.1 2021-01-01 -&gt; 2021-01-11 (D)</span></span>
<span><span class="co">#&gt; 4  2021-01-04    RTI Ward 3 E.1 2021-01-01 -&gt; 2021-01-11 (D)</span></span>
<span><span class="co">#&gt; 5  2021-01-05    BSI Ward 2 E.1 2021-01-01 -&gt; 2021-01-11 (D)</span></span>
<span><span class="co">#&gt; 6  2021-01-06    BSI Ward 2 E.1 2021-01-01 -&gt; 2021-01-11 (D)</span></span>
<span><span class="co">#&gt; 7  2021-01-07    BSI Ward 1 E.1 2021-01-01 -&gt; 2021-01-11 (D)</span></span>
<span><span class="co">#&gt; 8  2021-01-08    RTI Ward 1 E.1 2021-01-01 -&gt; 2021-01-11 (D)</span></span>
<span><span class="co">#&gt; 9  2021-01-09    RTI Ward 3 E.1 2021-01-01 -&gt; 2021-01-11 (D)</span></span>
<span><span class="co">#&gt; 10 2021-01-10    BSI Ward 3 E.1 2021-01-01 -&gt; 2021-01-11 (D)</span></span>
<span><span class="co">#&gt; 11 2021-01-11    RTI Ward 2 E.1 2021-01-01 -&gt; 2021-01-11 (D)</span></span></code></pre></div>
<p>As seen above, we can use <code><a href="../reference/episodes.html">episodes()</a></code> to create a group
identifier unique to each occurrence. Each group is referred to as an
episode. The identifier is stored as an <code>S4</code>
(<code>epid</code>) class with useful information about each group in
its slots. These information can be accessed with
<code><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame()</a></code> or <code><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list()</a></code>.</p>
<p>We can build on this case definition by adding a temporal boundary
within which events are considered part of the same occurrence. For
example, we can specify that only events within 4 days (3
day-difference) of an index are considered part of the same
occurrence.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">event_dt</span><span class="op">$</span><span class="va">ep2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/episodes.html">episodes</a></span><span class="op">(</span><span class="va">event_dt</span><span class="op">$</span><span class="va">date</span>, <span class="fl">3</span>, episode_type <span class="op">=</span> <span class="st">"fixed"</span><span class="op">)</span></span>
<span><span class="va">event_dt</span></span>
<span><span class="co">#&gt;          date attr_1 attr_2                              ep1</span></span>
<span><span class="co">#&gt; 1  2021-01-01    BSI Ward 1 E.1 2021-01-01 -&gt; 2021-01-11 (C)</span></span>
<span><span class="co">#&gt; 2  2021-01-02    UTI Ward 1 E.1 2021-01-01 -&gt; 2021-01-11 (D)</span></span>
<span><span class="co">#&gt; 3  2021-01-03    RTI Ward 3 E.1 2021-01-01 -&gt; 2021-01-11 (D)</span></span>
<span><span class="co">#&gt; 4  2021-01-04    RTI Ward 3 E.1 2021-01-01 -&gt; 2021-01-11 (D)</span></span>
<span><span class="co">#&gt; 5  2021-01-05    BSI Ward 2 E.1 2021-01-01 -&gt; 2021-01-11 (D)</span></span>
<span><span class="co">#&gt; 6  2021-01-06    BSI Ward 2 E.1 2021-01-01 -&gt; 2021-01-11 (D)</span></span>
<span><span class="co">#&gt; 7  2021-01-07    BSI Ward 1 E.1 2021-01-01 -&gt; 2021-01-11 (D)</span></span>
<span><span class="co">#&gt; 8  2021-01-08    RTI Ward 1 E.1 2021-01-01 -&gt; 2021-01-11 (D)</span></span>
<span><span class="co">#&gt; 9  2021-01-09    RTI Ward 3 E.1 2021-01-01 -&gt; 2021-01-11 (D)</span></span>
<span><span class="co">#&gt; 10 2021-01-10    BSI Ward 3 E.1 2021-01-01 -&gt; 2021-01-11 (D)</span></span>
<span><span class="co">#&gt; 11 2021-01-11    RTI Ward 2 E.1 2021-01-01 -&gt; 2021-01-11 (D)</span></span>
<span><span class="co">#&gt;                                 ep2</span></span>
<span><span class="co">#&gt; 1  E.1 2021-01-01 -&gt; 2021-01-04 (C)</span></span>
<span><span class="co">#&gt; 2  E.1 2021-01-01 -&gt; 2021-01-04 (D)</span></span>
<span><span class="co">#&gt; 3  E.1 2021-01-01 -&gt; 2021-01-04 (D)</span></span>
<span><span class="co">#&gt; 4  E.1 2021-01-01 -&gt; 2021-01-04 (D)</span></span>
<span><span class="co">#&gt; 5  E.5 2021-01-05 -&gt; 2021-01-08 (C)</span></span>
<span><span class="co">#&gt; 6  E.5 2021-01-05 -&gt; 2021-01-08 (D)</span></span>
<span><span class="co">#&gt; 7  E.5 2021-01-05 -&gt; 2021-01-08 (D)</span></span>
<span><span class="co">#&gt; 8  E.5 2021-01-05 -&gt; 2021-01-08 (D)</span></span>
<span><span class="co">#&gt; 9  E.9 2021-01-09 -&gt; 2021-01-11 (C)</span></span>
<span><span class="co">#&gt; 10 E.9 2021-01-09 -&gt; 2021-01-11 (D)</span></span>
<span><span class="co">#&gt; 11 E.9 2021-01-09 -&gt; 2021-01-11 (D)</span></span></code></pre></div>
<p>We can see that every event after the fourth day has now been
assigned to a different episode, each with its own index event. This
type of episode is referred to as a <code>"fixed"</code> episode.</p>
<p><code><a href="../reference/episodes.html">episodes()</a></code> can also produce <code>"rolling"</code>
(recurring) episodes. See examples of each below.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">event_dt</span><span class="op">$</span><span class="va">ep3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/episodes.html">episodes</a></span><span class="op">(</span><span class="va">event_dt</span><span class="op">$</span><span class="va">date</span>, <span class="fl">3</span>, episode_type <span class="op">=</span> <span class="st">"rolling"</span><span class="op">)</span></span>
<span><span class="va">event_dt</span><span class="op">$</span><span class="va">ep4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/episodes.html">episodes</a></span><span class="op">(</span><span class="va">event_dt</span><span class="op">$</span><span class="va">date</span>, <span class="fl">3</span>, </span>
<span>                         episode_type <span class="op">=</span> <span class="st">"rolling"</span>, reference_event <span class="op">=</span> <span class="st">"all_record"</span><span class="op">)</span></span>
<span><span class="va">event_dt</span></span>
<span><span class="co">#&gt;          date attr_1 attr_2                              ep1</span></span>
<span><span class="co">#&gt; 1  2021-01-01    BSI Ward 1 E.1 2021-01-01 -&gt; 2021-01-11 (C)</span></span>
<span><span class="co">#&gt; 2  2021-01-02    UTI Ward 1 E.1 2021-01-01 -&gt; 2021-01-11 (D)</span></span>
<span><span class="co">#&gt; 3  2021-01-03    RTI Ward 3 E.1 2021-01-01 -&gt; 2021-01-11 (D)</span></span>
<span><span class="co">#&gt; 4  2021-01-04    RTI Ward 3 E.1 2021-01-01 -&gt; 2021-01-11 (D)</span></span>
<span><span class="co">#&gt; 5  2021-01-05    BSI Ward 2 E.1 2021-01-01 -&gt; 2021-01-11 (D)</span></span>
<span><span class="co">#&gt; 6  2021-01-06    BSI Ward 2 E.1 2021-01-01 -&gt; 2021-01-11 (D)</span></span>
<span><span class="co">#&gt; 7  2021-01-07    BSI Ward 1 E.1 2021-01-01 -&gt; 2021-01-11 (D)</span></span>
<span><span class="co">#&gt; 8  2021-01-08    RTI Ward 1 E.1 2021-01-01 -&gt; 2021-01-11 (D)</span></span>
<span><span class="co">#&gt; 9  2021-01-09    RTI Ward 3 E.1 2021-01-01 -&gt; 2021-01-11 (D)</span></span>
<span><span class="co">#&gt; 10 2021-01-10    BSI Ward 3 E.1 2021-01-01 -&gt; 2021-01-11 (D)</span></span>
<span><span class="co">#&gt; 11 2021-01-11    RTI Ward 2 E.1 2021-01-01 -&gt; 2021-01-11 (D)</span></span>
<span><span class="co">#&gt;                                 ep2                              ep3</span></span>
<span><span class="co">#&gt; 1  E.1 2021-01-01 -&gt; 2021-01-04 (C) E.1 2021-01-01 -&gt; 2021-01-11 (C)</span></span>
<span><span class="co">#&gt; 2  E.1 2021-01-01 -&gt; 2021-01-04 (D) E.1 2021-01-01 -&gt; 2021-01-11 (D)</span></span>
<span><span class="co">#&gt; 3  E.1 2021-01-01 -&gt; 2021-01-04 (D) E.1 2021-01-01 -&gt; 2021-01-11 (D)</span></span>
<span><span class="co">#&gt; 4  E.1 2021-01-01 -&gt; 2021-01-04 (D) E.1 2021-01-01 -&gt; 2021-01-11 (D)</span></span>
<span><span class="co">#&gt; 5  E.5 2021-01-05 -&gt; 2021-01-08 (C) E.1 2021-01-01 -&gt; 2021-01-11 (R)</span></span>
<span><span class="co">#&gt; 6  E.5 2021-01-05 -&gt; 2021-01-08 (D) E.1 2021-01-01 -&gt; 2021-01-11 (D)</span></span>
<span><span class="co">#&gt; 7  E.5 2021-01-05 -&gt; 2021-01-08 (D) E.1 2021-01-01 -&gt; 2021-01-11 (D)</span></span>
<span><span class="co">#&gt; 8  E.5 2021-01-05 -&gt; 2021-01-08 (D) E.1 2021-01-01 -&gt; 2021-01-11 (R)</span></span>
<span><span class="co">#&gt; 9  E.9 2021-01-09 -&gt; 2021-01-11 (C) E.1 2021-01-01 -&gt; 2021-01-11 (D)</span></span>
<span><span class="co">#&gt; 10 E.9 2021-01-09 -&gt; 2021-01-11 (D) E.1 2021-01-01 -&gt; 2021-01-11 (D)</span></span>
<span><span class="co">#&gt; 11 E.9 2021-01-09 -&gt; 2021-01-11 (D) E.1 2021-01-01 -&gt; 2021-01-11 (R)</span></span>
<span><span class="co">#&gt;                                 ep4</span></span>
<span><span class="co">#&gt; 1  E.1 2021-01-01 -&gt; 2021-01-11 (C)</span></span>
<span><span class="co">#&gt; 2  E.1 2021-01-01 -&gt; 2021-01-11 (D)</span></span>
<span><span class="co">#&gt; 3  E.1 2021-01-01 -&gt; 2021-01-11 (D)</span></span>
<span><span class="co">#&gt; 4  E.1 2021-01-01 -&gt; 2021-01-11 (D)</span></span>
<span><span class="co">#&gt; 5  E.1 2021-01-01 -&gt; 2021-01-11 (R)</span></span>
<span><span class="co">#&gt; 6  E.1 2021-01-01 -&gt; 2021-01-11 (D)</span></span>
<span><span class="co">#&gt; 7  E.1 2021-01-01 -&gt; 2021-01-11 (D)</span></span>
<span><span class="co">#&gt; 8  E.1 2021-01-01 -&gt; 2021-01-11 (R)</span></span>
<span><span class="co">#&gt; 9  E.1 2021-01-01 -&gt; 2021-01-11 (D)</span></span>
<span><span class="co">#&gt; 10 E.1 2021-01-01 -&gt; 2021-01-11 (D)</span></span>
<span><span class="co">#&gt; 11 E.1 2021-01-01 -&gt; 2021-01-11 (R)</span></span></code></pre></div>
<p>Here, we see the creation (or rather categorisation) of recurrent
events <code>(R)</code>. These are recurrence of index events as opposed
to their duplicates. For example, <code>ep3</code> initially ends on
<code>2021-01-04</code>. However, for rolling and recursive episodes,
the function takes the additional step of looking for other events
within 4 days of <code>2021-01-04</code>. Records within this period are
then categorised as recurrent events of the <code>2021-01-04</code>
event, which itself is a duplicate of the <code>2021-01-01</code> event.
This chaining process continues indefinitely until there are no more
events within the period of recurrence or it’s stop by the
<code>rolls_max</code> argument.</p>
<p>Even though <code>ep1</code> has the same outcome (one episode) as
<code>ep3</code> and <code>ep4</code>, they are very different case
definitions hence, the structure of their episodes are different. This
is demonstrated below by using <code><a href="../reference/schema.html">schema()</a></code> to visualise the
identifiers.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/schema.html">schema</a></span><span class="op">(</span><span class="va">event_dt</span><span class="op">$</span><span class="va">ep1</span>, seed <span class="op">=</span> <span class="fl">2</span>, show_labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"case_nm"</span>, <span class="st">"length_arrow"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="episodes_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/schema.html">schema</a></span><span class="op">(</span><span class="va">event_dt</span><span class="op">$</span><span class="va">ep3</span>, seed <span class="op">=</span> <span class="fl">2</span>, show_labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"case_nm"</span>, <span class="st">"length_arrow"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="episodes_files/figure-html/unnamed-chunk-6-2.png" width="672"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/schema.html">schema</a></span><span class="op">(</span><span class="va">event_dt</span><span class="op">$</span><span class="va">ep4</span>, seed <span class="op">=</span> <span class="fl">2</span>, show_labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"case_nm"</span>, <span class="st">"length_arrow"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="episodes_files/figure-html/unnamed-chunk-6-3.png" width="672"></p>
<p>You may have noticed that this process starts from the earliest event
and proceeds forward in time. If the <code>from_last</code> argument is
changed, the process will happen in the opposite direction.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">event_dt</span><span class="op">$</span><span class="va">ep5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/episodes.html">episodes</a></span><span class="op">(</span><span class="va">event_dt</span><span class="op">$</span><span class="va">date</span>, <span class="fl">3</span>, episode_type <span class="op">=</span> <span class="st">"rolling"</span>, from_last <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">event_dt</span></span>
<span><span class="co">#&gt;          date attr_1 attr_2                              ep1</span></span>
<span><span class="co">#&gt; 1  2021-01-01    BSI Ward 1 E.1 2021-01-01 -&gt; 2021-01-11 (C)</span></span>
<span><span class="co">#&gt; 2  2021-01-02    UTI Ward 1 E.1 2021-01-01 -&gt; 2021-01-11 (D)</span></span>
<span><span class="co">#&gt; 3  2021-01-03    RTI Ward 3 E.1 2021-01-01 -&gt; 2021-01-11 (D)</span></span>
<span><span class="co">#&gt; 4  2021-01-04    RTI Ward 3 E.1 2021-01-01 -&gt; 2021-01-11 (D)</span></span>
<span><span class="co">#&gt; 5  2021-01-05    BSI Ward 2 E.1 2021-01-01 -&gt; 2021-01-11 (D)</span></span>
<span><span class="co">#&gt; 6  2021-01-06    BSI Ward 2 E.1 2021-01-01 -&gt; 2021-01-11 (D)</span></span>
<span><span class="co">#&gt; 7  2021-01-07    BSI Ward 1 E.1 2021-01-01 -&gt; 2021-01-11 (D)</span></span>
<span><span class="co">#&gt; 8  2021-01-08    RTI Ward 1 E.1 2021-01-01 -&gt; 2021-01-11 (D)</span></span>
<span><span class="co">#&gt; 9  2021-01-09    RTI Ward 3 E.1 2021-01-01 -&gt; 2021-01-11 (D)</span></span>
<span><span class="co">#&gt; 10 2021-01-10    BSI Ward 3 E.1 2021-01-01 -&gt; 2021-01-11 (D)</span></span>
<span><span class="co">#&gt; 11 2021-01-11    RTI Ward 2 E.1 2021-01-01 -&gt; 2021-01-11 (D)</span></span>
<span><span class="co">#&gt;                                 ep2                              ep3</span></span>
<span><span class="co">#&gt; 1  E.1 2021-01-01 -&gt; 2021-01-04 (C) E.1 2021-01-01 -&gt; 2021-01-11 (C)</span></span>
<span><span class="co">#&gt; 2  E.1 2021-01-01 -&gt; 2021-01-04 (D) E.1 2021-01-01 -&gt; 2021-01-11 (D)</span></span>
<span><span class="co">#&gt; 3  E.1 2021-01-01 -&gt; 2021-01-04 (D) E.1 2021-01-01 -&gt; 2021-01-11 (D)</span></span>
<span><span class="co">#&gt; 4  E.1 2021-01-01 -&gt; 2021-01-04 (D) E.1 2021-01-01 -&gt; 2021-01-11 (D)</span></span>
<span><span class="co">#&gt; 5  E.5 2021-01-05 -&gt; 2021-01-08 (C) E.1 2021-01-01 -&gt; 2021-01-11 (R)</span></span>
<span><span class="co">#&gt; 6  E.5 2021-01-05 -&gt; 2021-01-08 (D) E.1 2021-01-01 -&gt; 2021-01-11 (D)</span></span>
<span><span class="co">#&gt; 7  E.5 2021-01-05 -&gt; 2021-01-08 (D) E.1 2021-01-01 -&gt; 2021-01-11 (D)</span></span>
<span><span class="co">#&gt; 8  E.5 2021-01-05 -&gt; 2021-01-08 (D) E.1 2021-01-01 -&gt; 2021-01-11 (R)</span></span>
<span><span class="co">#&gt; 9  E.9 2021-01-09 -&gt; 2021-01-11 (C) E.1 2021-01-01 -&gt; 2021-01-11 (D)</span></span>
<span><span class="co">#&gt; 10 E.9 2021-01-09 -&gt; 2021-01-11 (D) E.1 2021-01-01 -&gt; 2021-01-11 (D)</span></span>
<span><span class="co">#&gt; 11 E.9 2021-01-09 -&gt; 2021-01-11 (D) E.1 2021-01-01 -&gt; 2021-01-11 (R)</span></span>
<span><span class="co">#&gt;                                 ep4                               ep5</span></span>
<span><span class="co">#&gt; 1  E.1 2021-01-01 -&gt; 2021-01-11 (C) E.11 2021-01-11 &lt;- 2021-01-01 (R)</span></span>
<span><span class="co">#&gt; 2  E.1 2021-01-01 -&gt; 2021-01-11 (D) E.11 2021-01-11 &lt;- 2021-01-01 (D)</span></span>
<span><span class="co">#&gt; 3  E.1 2021-01-01 -&gt; 2021-01-11 (D) E.11 2021-01-11 &lt;- 2021-01-01 (D)</span></span>
<span><span class="co">#&gt; 4  E.1 2021-01-01 -&gt; 2021-01-11 (D) E.11 2021-01-11 &lt;- 2021-01-01 (R)</span></span>
<span><span class="co">#&gt; 5  E.1 2021-01-01 -&gt; 2021-01-11 (R) E.11 2021-01-11 &lt;- 2021-01-01 (D)</span></span>
<span><span class="co">#&gt; 6  E.1 2021-01-01 -&gt; 2021-01-11 (D) E.11 2021-01-11 &lt;- 2021-01-01 (D)</span></span>
<span><span class="co">#&gt; 7  E.1 2021-01-01 -&gt; 2021-01-11 (D) E.11 2021-01-11 &lt;- 2021-01-01 (R)</span></span>
<span><span class="co">#&gt; 8  E.1 2021-01-01 -&gt; 2021-01-11 (R) E.11 2021-01-11 &lt;- 2021-01-01 (D)</span></span>
<span><span class="co">#&gt; 9  E.1 2021-01-01 -&gt; 2021-01-11 (D) E.11 2021-01-11 &lt;- 2021-01-01 (D)</span></span>
<span><span class="co">#&gt; 10 E.1 2021-01-01 -&gt; 2021-01-11 (D) E.11 2021-01-11 &lt;- 2021-01-01 (D)</span></span>
<span><span class="co">#&gt; 11 E.1 2021-01-01 -&gt; 2021-01-11 (R) E.11 2021-01-11 &lt;- 2021-01-01 (C)</span></span></code></pre></div>
<p>We can now see that in <code>ep5</code> the last record is now the
index of the episode.</p>
<p>So far, we’ve discussed the different type of episodes and the
direction of time in which they are tracked. The next important part of
the tracking process is the selection of index events. This determines
which record is used as the reference point when checking for other
events within its window of occurrence. By default, this will be the
earliest record from the direction of the tracking process but this can
be changed to a custom preference using the <code>custom_sort</code>
argument.</p>
<p>To demonstrate this, let’s preferentially use <code>"RTI"</code>
infection events as index events for episodes.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">custom_pref</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">event_dt</span><span class="op">$</span><span class="va">attr_1</span> <span class="op">==</span> <span class="st">"RTI"</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">event_dt</span><span class="op">$</span><span class="va">ep6</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/episodes.html">episodes</a></span><span class="op">(</span><span class="va">event_dt</span><span class="op">$</span><span class="va">date</span>, <span class="fl">3</span>, custom_sort <span class="op">=</span> <span class="va">custom_pref</span>, </span>
<span>                         skip_order <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">event_dt</span><span class="op">$</span><span class="va">ep7</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/episodes.html">episodes</a></span><span class="op">(</span><span class="va">event_dt</span><span class="op">$</span><span class="va">date</span>, <span class="fl">3</span>, custom_sort <span class="op">=</span> <span class="va">custom_pref</span>, </span>
<span>                         skip_order <span class="op">=</span> <span class="fl">1</span>, from_last <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/schema.html">schema</a></span><span class="op">(</span><span class="va">event_dt</span><span class="op">$</span><span class="va">ep6</span>, seed <span class="op">=</span> <span class="fl">2</span>, show_labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"length_arrow"</span><span class="op">)</span>, </span>
<span>       custom_label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="../reference/encode.html">decode</a></span><span class="op">(</span><span class="va">event_dt</span><span class="op">$</span><span class="va">ep6</span><span class="op">@</span><span class="va">case_nm</span><span class="op">)</span>, <span class="st">" ("</span>, <span class="va">event_dt</span><span class="op">$</span><span class="va">attr_1</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="episodes_files/figure-html/unnamed-chunk-9-1.png" width="672"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/schema.html">schema</a></span><span class="op">(</span><span class="va">event_dt</span><span class="op">$</span><span class="va">ep7</span>, seed <span class="op">=</span> <span class="fl">2</span>, show_labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"length_arrow"</span><span class="op">)</span>, </span>
<span>       custom_label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="../reference/encode.html">decode</a></span><span class="op">(</span><span class="va">event_dt</span><span class="op">$</span><span class="va">ep7</span><span class="op">@</span><span class="va">case_nm</span><span class="op">)</span>, <span class="st">" ("</span>, <span class="va">event_dt</span><span class="op">$</span><span class="va">attr_1</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="episodes_files/figure-html/unnamed-chunk-9-2.png" width="672"></p>
<p>Another main aspect of the tracking process is the duration between
events. This is handled by the <code>case_length</code> and
<code>recurrence_length</code> arguments. A length of <code>3</code>
means that events within 4 days (3-day difference) of the of the index
event will be linked together as part of the same occurrence. Note that
this is 4 days towards the direction of the tracking process therefore,
events in the opposite direction will not be considered. We can see this
above in the schema for <code>ep6</code>.</p>
<p>If records in both directions need to be considered, then a range can
be provided as shown with <code>ep_8</code>. Additionally, multiple
periods from the index event can be specified by providing a list of
lengths or ranges as shown in <code>ep_9</code>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">event_dt</span><span class="op">$</span><span class="va">ep8</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/episodes.html">episodes</a></span><span class="op">(</span><span class="va">event_dt</span><span class="op">$</span><span class="va">date</span>, <span class="fu"><a href="../reference/number_line.html">number_line</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>, episode_type <span class="op">=</span> <span class="st">"fixed"</span>, </span>
<span>                         custom_sort <span class="op">=</span> <span class="va">custom_pref</span>, skip_order <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">event_dt</span><span class="op">$</span><span class="va">ep9</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/episodes.html">episodes</a></span><span class="op">(</span><span class="va">event_dt</span><span class="op">$</span><span class="va">date</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="../reference/number_line.html">number_line</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>                                             <span class="fu"><a href="../reference/number_line.html">number_line</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>                                             <span class="fu"><a href="../reference/number_line.html">number_line</a></span><span class="op">(</span><span class="fl">7</span>, <span class="fl">9</span><span class="op">)</span><span class="op">)</span>, episode_type <span class="op">=</span> <span class="st">"fixed"</span>, </span>
<span>                         custom_sort <span class="op">=</span> <span class="va">custom_pref</span>, </span>
<span>                         skip_order <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                         skip_if_b4_lengths <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/schema.html">schema</a></span><span class="op">(</span><span class="va">event_dt</span><span class="op">$</span><span class="va">ep8</span>, seed <span class="op">=</span> <span class="fl">2</span>, show_labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"length_arrow"</span><span class="op">)</span>, </span>
<span>       custom_label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="../reference/encode.html">decode</a></span><span class="op">(</span><span class="va">event_dt</span><span class="op">$</span><span class="va">ep8</span><span class="op">@</span><span class="va">case_nm</span><span class="op">)</span>, <span class="st">" ("</span>, <span class="va">event_dt</span><span class="op">$</span><span class="va">attr_1</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="episodes_files/figure-html/unnamed-chunk-11-1.png" width="672"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/schema.html">schema</a></span><span class="op">(</span><span class="va">event_dt</span><span class="op">$</span><span class="va">ep9</span>, seed <span class="op">=</span> <span class="fl">2</span>, show_labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"length_arrow"</span>, <span class="st">"length"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="episodes_files/figure-html/unnamed-chunk-11-2.png" width="672"></p>
<p>It’s possible to track episodes among events with known start and end
points, instead of those occurring at a single point in time. It is
worth noting that the reference point for such events is their end
point. Therefore, using a <code>case_length</code> of <code>1</code>
when working with such events is interpreted as 2 days (1-day
difference) after the end point of the interval. By default, other
events that occur on or after the start point but before the end point
of the index event will not be captured. If this is required, use
<code><a href="../reference/windows.html">index_window()</a></code> to get the range required to capture such
events, and supply it to the <code>case_length</code> or
<code>recurrence_length</code> arguments. See the examples below.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Dummy data of hospital stays</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">hospital_admissions</span><span class="op">)</span></span>
<span><span class="va">dfr</span> <span class="op">&lt;-</span> <span class="va">hospital_admissions</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"admin_dt"</span>, <span class="st">"discharge_dt"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">dfr</span><span class="op">$</span><span class="va">admin_period</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/number_line.html">number_line</a></span><span class="op">(</span><span class="va">dfr</span><span class="op">$</span><span class="va">admin_dt</span>, <span class="va">dfr</span><span class="op">$</span><span class="va">discharge_dt</span><span class="op">)</span></span>
<span>                                  </span>
<span><span class="co"># Group overlapping hospital stays</span></span>
<span><span class="va">dfr</span><span class="op">$</span><span class="va">ep_len1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/windows.html">index_window</a></span><span class="op">(</span><span class="va">dfr</span><span class="op">$</span><span class="va">admin_period</span><span class="op">)</span></span>
<span><span class="va">dfr</span><span class="op">$</span><span class="va">ep1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/episodes.html">episodes</a></span><span class="op">(</span>date <span class="op">=</span> <span class="va">dfr</span><span class="op">$</span><span class="va">admin_period</span>, case_length <span class="op">=</span> <span class="va">dfr</span><span class="op">$</span><span class="va">ep_len1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Group overlapping hospital stays and those within 21 days of the end point of an index hospital stay </span></span>
<span><span class="va">dfr</span><span class="op">$</span><span class="va">ep_len2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/number_line.html">expand_number_line</a></span><span class="op">(</span><span class="fu"><a href="../reference/windows.html">index_window</a></span><span class="op">(</span><span class="va">dfr</span><span class="op">$</span><span class="va">admin_period</span><span class="op">)</span>, <span class="fl">20</span>, <span class="st">"right"</span><span class="op">)</span></span>
<span><span class="va">dfr</span><span class="op">$</span><span class="va">ep2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/episodes.html">episodes</a></span><span class="op">(</span>date <span class="op">=</span> <span class="va">dfr</span><span class="op">$</span><span class="va">admin_period</span>, case_length <span class="op">=</span>  <span class="va">dfr</span><span class="op">$</span><span class="va">ep_len2</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dfr</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"admin_period"</span>, <span class="st">"ep_len1"</span>, <span class="st">"ep_len2"</span>, <span class="st">"ep1"</span>, <span class="st">"ep2"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt;                admin_period  ep_len1   ep_len2                              ep1</span></span>
<span><span class="co">#&gt; 1  2019-01-01 == 2019-01-01   0 == 0   0 -&gt; 20 E.2 2019-01-01 -&gt; 2019-01-15 (D)</span></span>
<span><span class="co">#&gt; 2  2019-01-01 -&gt; 2019-01-10  -9 -&gt; 0  -9 -&gt; 20 E.2 2019-01-01 -&gt; 2019-01-15 (C)</span></span>
<span><span class="co">#&gt; 3  2019-01-10 -&gt; 2019-01-13  -3 -&gt; 0  -3 -&gt; 20 E.2 2019-01-01 -&gt; 2019-01-15 (D)</span></span>
<span><span class="co">#&gt; 4  2019-01-05 -&gt; 2019-01-06  -1 -&gt; 0  -1 -&gt; 20 E.2 2019-01-01 -&gt; 2019-01-15 (D)</span></span>
<span><span class="co">#&gt; 5  2019-01-05 -&gt; 2019-01-15 -10 -&gt; 0 -10 -&gt; 20 E.2 2019-01-01 -&gt; 2019-01-15 (D)</span></span>
<span><span class="co">#&gt; 6  2019-01-07 -&gt; 2019-01-15  -8 -&gt; 0  -8 -&gt; 20 E.2 2019-01-01 -&gt; 2019-01-15 (D)</span></span>
<span><span class="co">#&gt; 7  2019-01-04 -&gt; 2019-01-13  -9 -&gt; 0  -9 -&gt; 20 E.2 2019-01-01 -&gt; 2019-01-15 (D)</span></span>
<span><span class="co">#&gt; 8  2019-01-20 -&gt; 2019-01-30 -10 -&gt; 0 -10 -&gt; 20 E.8 2019-01-20 -&gt; 2019-01-31 (C)</span></span>
<span><span class="co">#&gt; 9  2019-01-26 -&gt; 2019-01-31  -5 -&gt; 0  -5 -&gt; 20 E.8 2019-01-20 -&gt; 2019-01-31 (D)</span></span>
<span><span class="co">#&gt; 10 2019-01-01 -&gt; 2019-01-10  -9 -&gt; 0  -9 -&gt; 20 E.2 2019-01-01 -&gt; 2019-01-15 (D)</span></span>
<span><span class="co">#&gt; 11 2019-01-20 -&gt; 2019-01-30 -10 -&gt; 0 -10 -&gt; 20 E.8 2019-01-20 -&gt; 2019-01-31 (D)</span></span>
<span><span class="co">#&gt;                                 ep2</span></span>
<span><span class="co">#&gt; 1  E.2 2019-01-01 -&gt; 2019-01-31 (D)</span></span>
<span><span class="co">#&gt; 2  E.2 2019-01-01 -&gt; 2019-01-31 (C)</span></span>
<span><span class="co">#&gt; 3  E.2 2019-01-01 -&gt; 2019-01-31 (D)</span></span>
<span><span class="co">#&gt; 4  E.2 2019-01-01 -&gt; 2019-01-31 (D)</span></span>
<span><span class="co">#&gt; 5  E.2 2019-01-01 -&gt; 2019-01-31 (D)</span></span>
<span><span class="co">#&gt; 6  E.2 2019-01-01 -&gt; 2019-01-31 (D)</span></span>
<span><span class="co">#&gt; 7  E.2 2019-01-01 -&gt; 2019-01-31 (D)</span></span>
<span><span class="co">#&gt; 8  E.2 2019-01-01 -&gt; 2019-01-31 (D)</span></span>
<span><span class="co">#&gt; 9  E.2 2019-01-01 -&gt; 2019-01-31 (D)</span></span>
<span><span class="co">#&gt; 10 E.2 2019-01-01 -&gt; 2019-01-31 (D)</span></span>
<span><span class="co">#&gt; 11 E.2 2019-01-01 -&gt; 2019-01-31 (D)</span></span>
<span><span class="fu"><a href="../reference/schema.html">schema</a></span><span class="op">(</span><span class="va">dfr</span><span class="op">$</span><span class="va">ep1</span>, seed <span class="op">=</span> <span class="fl">2</span>, show_labels <span class="op">=</span> <span class="st">"length_arrow"</span><span class="op">)</span></span></code></pre></div>
<p><img src="episodes_files/figure-html/unnamed-chunk-13-1.png" width="672"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/schema.html">schema</a></span><span class="op">(</span><span class="va">dfr</span><span class="op">$</span><span class="va">ep2</span>, seed <span class="op">=</span> <span class="fl">2</span>, show_labels <span class="op">=</span> <span class="st">"length_arrow"</span><span class="op">)</span></span></code></pre></div>
<p><img src="episodes_files/figure-html/unnamed-chunk-13-2.png" width="672"></p>
<p>Currently, the <code>diyar</code> packages recognises 7 mutually
exclusive and 2 mutually inclusive ways a pair of intervals can overlap.
Please see <code><a href="../articles/number_line.html">vignette("number_line")</a></code> for more details about
this. Using <code>case_overlap_methods</code> and
<code>recurrence_overlap_methods</code>, the episode tracking process
can be made to only capture intervals that overlap by specific methods.
See the example below.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Wrapper function for a fixed episode</span></span>
<span><span class="va">episodes_wf</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">epids</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/episodes.html">episodes</a></span><span class="op">(</span>date <span class="op">=</span> <span class="va">dfr</span><span class="op">$</span><span class="va">admin_period</span>, </span>
<span>                    sn <span class="op">=</span> <span class="va">dfr</span><span class="op">$</span><span class="va">rd_id</span>, </span>
<span>                    case_length <span class="op">=</span> <span class="fu"><a href="../reference/windows.html">index_window</a></span><span class="op">(</span><span class="va">dfr</span><span class="op">$</span><span class="va">admin_period</span><span class="op">)</span>, </span>
<span>                    case_overlap_methods <span class="op">=</span> <span class="va">x</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">epids</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Methods </span></span>
<span><span class="va">methods</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="co"># Identical intervals</span></span>
<span>  exact <span class="op">=</span> <span class="st">"exact"</span>,</span>
<span>  <span class="co"># Intervals with their start or end points within another</span></span>
<span>  across <span class="op">=</span> <span class="st">"across"</span>,</span>
<span>  <span class="co"># Intervals with aligned start points</span></span>
<span>  aligns_start <span class="op">=</span> <span class="st">"aligns_start"</span>,</span>
<span>  <span class="co"># Intervals with aligned end points</span></span>
<span>  aligns_end <span class="op">=</span> <span class="st">"aligns_end"</span>,</span>
<span>  <span class="co"># Intervals with start points that align with the end point of another, and vice versa</span></span>
<span>  chain <span class="op">=</span> <span class="st">"chain"</span>,</span>
<span>  <span class="co"># Intervals occurring completely within others</span></span>
<span>  inbetween <span class="op">=</span> <span class="st">"inbetween"</span>,</span>
<span>  <span class="co"># A combination of `chain` and `inbetween` methods</span></span>
<span>  cb1 <span class="op">=</span> <span class="st">"chain|inbetween"</span>,</span>
<span>  <span class="co"># A combination of `exact`, `chain` and `inbetween` methods</span></span>
<span>  cb2 <span class="op">=</span> <span class="st">"exact|chain|inbetween"</span>,</span>
<span>  <span class="co"># A combination of `across`, `chain` and `aligns_end` methods</span></span>
<span>  cb3 <span class="op">=</span> <span class="st">"across|chain|aligns_end"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">epids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">methods</span>, <span class="va">episodes_wf</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">epids</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">methods</span></span>
<span></span>
<span><span class="co"># Use `schema()` to visualise each.</span></span>
<span><span class="va">epids</span></span>
<span><span class="co">#&gt; $exact</span></span>
<span><span class="co">#&gt;  [1] "E.1 2019-01-01 == 2019-01-01 (C)" "E.2 2019-01-01 -&gt; 2019-01-10 (C)"</span></span>
<span><span class="co">#&gt;  [3] "E.3 2019-01-10 -&gt; 2019-01-13 (C)" "E.4 2019-01-05 -&gt; 2019-01-06 (C)"</span></span>
<span><span class="co">#&gt;  [5] "E.5 2019-01-05 -&gt; 2019-01-15 (C)" "E.6 2019-01-07 -&gt; 2019-01-15 (C)"</span></span>
<span><span class="co">#&gt;  [7] "E.7 2019-01-04 -&gt; 2019-01-13 (C)" "E.8 2019-01-20 -&gt; 2019-01-30 (C)"</span></span>
<span><span class="co">#&gt;  [9] "E.9 2019-01-26 -&gt; 2019-01-31 (C)" "E.2 2019-01-01 -&gt; 2019-01-10 (D)"</span></span>
<span><span class="co">#&gt; [11] "E.8 2019-01-20 -&gt; 2019-01-30 (D)"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $across</span></span>
<span><span class="co">#&gt;  [1] "E.01 2019-01-01 == 2019-01-01 (C)" "E.02 2019-01-01 -&gt; 2019-01-15 (C)"</span></span>
<span><span class="co">#&gt;  [3] "E.03 2019-01-10 -&gt; 2019-01-13 (C)" "E.04 2019-01-05 -&gt; 2019-01-06 (C)"</span></span>
<span><span class="co">#&gt;  [5] "E.02 2019-01-01 -&gt; 2019-01-15 (D)" "E.02 2019-01-01 -&gt; 2019-01-15 (D)"</span></span>
<span><span class="co">#&gt;  [7] "E.02 2019-01-01 -&gt; 2019-01-15 (D)" "E.08 2019-01-20 -&gt; 2019-01-31 (C)"</span></span>
<span><span class="co">#&gt;  [9] "E.08 2019-01-20 -&gt; 2019-01-31 (D)" "E.10 2019-01-01 -&gt; 2019-01-10 (C)"</span></span>
<span><span class="co">#&gt; [11] "E.11 2019-01-20 -&gt; 2019-01-30 (C)"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $aligns_start</span></span>
<span><span class="co">#&gt;  [1] "E.02 2019-01-01 -&gt; 2019-01-10 (D)" "E.02 2019-01-01 -&gt; 2019-01-10 (C)"</span></span>
<span><span class="co">#&gt;  [3] "E.03 2019-01-10 -&gt; 2019-01-13 (C)" "E.05 2019-01-05 -&gt; 2019-01-15 (D)"</span></span>
<span><span class="co">#&gt;  [5] "E.05 2019-01-05 -&gt; 2019-01-15 (C)" "E.06 2019-01-07 -&gt; 2019-01-15 (C)"</span></span>
<span><span class="co">#&gt;  [7] "E.07 2019-01-04 -&gt; 2019-01-13 (C)" "E.08 2019-01-20 -&gt; 2019-01-30 (C)"</span></span>
<span><span class="co">#&gt;  [9] "E.09 2019-01-26 -&gt; 2019-01-31 (C)" "E.10 2019-01-01 -&gt; 2019-01-10 (C)"</span></span>
<span><span class="co">#&gt; [11] "E.11 2019-01-20 -&gt; 2019-01-30 (C)"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $aligns_end</span></span>
<span><span class="co">#&gt;  [1] "E.01 2019-01-01 == 2019-01-01 (C)" "E.02 2019-01-01 -&gt; 2019-01-10 (C)"</span></span>
<span><span class="co">#&gt;  [3] "E.07 2019-01-04 -&gt; 2019-01-13 (D)" "E.04 2019-01-05 -&gt; 2019-01-06 (C)"</span></span>
<span><span class="co">#&gt;  [5] "E.05 2019-01-05 -&gt; 2019-01-15 (C)" "E.05 2019-01-05 -&gt; 2019-01-15 (D)"</span></span>
<span><span class="co">#&gt;  [7] "E.07 2019-01-04 -&gt; 2019-01-13 (C)" "E.08 2019-01-20 -&gt; 2019-01-30 (C)"</span></span>
<span><span class="co">#&gt;  [9] "E.09 2019-01-26 -&gt; 2019-01-31 (C)" "E.10 2019-01-01 -&gt; 2019-01-10 (C)"</span></span>
<span><span class="co">#&gt; [11] "E.11 2019-01-20 -&gt; 2019-01-30 (C)"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $chain</span></span>
<span><span class="co">#&gt;  [1] "E.01 2019-01-01 == 2019-01-01 (C)" "E.02 2019-01-01 -&gt; 2019-01-13 (C)"</span></span>
<span><span class="co">#&gt;  [3] "E.02 2019-01-01 -&gt; 2019-01-13 (D)" "E.04 2019-01-05 -&gt; 2019-01-06 (C)"</span></span>
<span><span class="co">#&gt;  [5] "E.05 2019-01-05 -&gt; 2019-01-15 (C)" "E.06 2019-01-07 -&gt; 2019-01-15 (C)"</span></span>
<span><span class="co">#&gt;  [7] "E.07 2019-01-04 -&gt; 2019-01-13 (C)" "E.08 2019-01-20 -&gt; 2019-01-30 (C)"</span></span>
<span><span class="co">#&gt;  [9] "E.09 2019-01-26 -&gt; 2019-01-31 (C)" "E.10 2019-01-01 -&gt; 2019-01-10 (C)"</span></span>
<span><span class="co">#&gt; [11] "E.11 2019-01-20 -&gt; 2019-01-30 (C)"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $inbetween</span></span>
<span><span class="co">#&gt;  [1] "E.01 2019-01-01 == 2019-01-01 (C)" "E.02 2019-01-01 -&gt; 2019-01-10 (C)"</span></span>
<span><span class="co">#&gt;  [3] "E.05 2019-01-05 -&gt; 2019-01-15 (D)" "E.02 2019-01-01 -&gt; 2019-01-10 (D)"</span></span>
<span><span class="co">#&gt;  [5] "E.05 2019-01-05 -&gt; 2019-01-15 (C)" "E.06 2019-01-07 -&gt; 2019-01-15 (C)"</span></span>
<span><span class="co">#&gt;  [7] "E.07 2019-01-04 -&gt; 2019-01-13 (C)" "E.08 2019-01-20 -&gt; 2019-01-30 (C)"</span></span>
<span><span class="co">#&gt;  [9] "E.09 2019-01-26 -&gt; 2019-01-31 (C)" "E.10 2019-01-01 -&gt; 2019-01-10 (C)"</span></span>
<span><span class="co">#&gt; [11] "E.11 2019-01-20 -&gt; 2019-01-30 (C)"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`chain|inbetween`</span></span>
<span><span class="co">#&gt;  [1] "E.01 2019-01-01 == 2019-01-01 (C)" "E.02 2019-01-01 -&gt; 2019-01-13 (C)"</span></span>
<span><span class="co">#&gt;  [3] "E.02 2019-01-01 -&gt; 2019-01-13 (D)" "E.02 2019-01-01 -&gt; 2019-01-13 (D)"</span></span>
<span><span class="co">#&gt;  [5] "E.05 2019-01-05 -&gt; 2019-01-15 (C)" "E.06 2019-01-07 -&gt; 2019-01-15 (C)"</span></span>
<span><span class="co">#&gt;  [7] "E.07 2019-01-04 -&gt; 2019-01-13 (C)" "E.08 2019-01-20 -&gt; 2019-01-30 (C)"</span></span>
<span><span class="co">#&gt;  [9] "E.09 2019-01-26 -&gt; 2019-01-31 (C)" "E.10 2019-01-01 -&gt; 2019-01-10 (C)"</span></span>
<span><span class="co">#&gt; [11] "E.11 2019-01-20 -&gt; 2019-01-30 (C)"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`exact|chain|inbetween`</span></span>
<span><span class="co">#&gt;  [1] "E.1 2019-01-01 == 2019-01-01 (C)" "E.2 2019-01-01 -&gt; 2019-01-13 (C)"</span></span>
<span><span class="co">#&gt;  [3] "E.2 2019-01-01 -&gt; 2019-01-13 (D)" "E.2 2019-01-01 -&gt; 2019-01-13 (D)"</span></span>
<span><span class="co">#&gt;  [5] "E.5 2019-01-05 -&gt; 2019-01-15 (C)" "E.6 2019-01-07 -&gt; 2019-01-15 (C)"</span></span>
<span><span class="co">#&gt;  [7] "E.7 2019-01-04 -&gt; 2019-01-13 (C)" "E.8 2019-01-20 -&gt; 2019-01-30 (C)"</span></span>
<span><span class="co">#&gt;  [9] "E.9 2019-01-26 -&gt; 2019-01-31 (C)" "E.2 2019-01-01 -&gt; 2019-01-13 (D)"</span></span>
<span><span class="co">#&gt; [11] "E.8 2019-01-20 -&gt; 2019-01-30 (D)"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`across|chain|aligns_end`</span></span>
<span><span class="co">#&gt;  [1] "E.01 2019-01-01 == 2019-01-01 (C)" "E.02 2019-01-01 -&gt; 2019-01-15 (C)"</span></span>
<span><span class="co">#&gt;  [3] "E.02 2019-01-01 -&gt; 2019-01-15 (D)" "E.04 2019-01-05 -&gt; 2019-01-06 (C)"</span></span>
<span><span class="co">#&gt;  [5] "E.02 2019-01-01 -&gt; 2019-01-15 (D)" "E.02 2019-01-01 -&gt; 2019-01-15 (D)"</span></span>
<span><span class="co">#&gt;  [7] "E.02 2019-01-01 -&gt; 2019-01-15 (D)" "E.08 2019-01-20 -&gt; 2019-01-31 (C)"</span></span>
<span><span class="co">#&gt;  [9] "E.08 2019-01-20 -&gt; 2019-01-31 (D)" "E.10 2019-01-01 -&gt; 2019-01-10 (C)"</span></span>
<span><span class="co">#&gt; [11] "E.11 2019-01-20 -&gt; 2019-01-30 (C)"</span></span></code></pre></div>
<p>See <code>overlap_methods$options</code> for a list of supported
options.</p>
<p>Additional matching criteria (separate from temporal links) can be
implemented by passing a <code>sub_criteria</code> object to the
<code>case_sub_criteria</code> and <code>recurrence_sub_criteria</code>
arguments. See the <code><a href="../articles/links.html">vignette("links")</a></code> for more details about
<code>sub_criteria</code> objects. In the example below, we specify that
only index events that are an RTI or occurred in Ward 3 can start an
episode.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">match_funx1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="va">y</span> <span class="op">==</span> <span class="st">"RTI"</span></span>
<span><span class="va">match_funx2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="va">y</span> <span class="op">==</span> <span class="st">"Ward 2"</span></span>
<span><span class="co"># Sub-criteria 1 - Matching source of infection OR patient location</span></span>
<span><span class="va">sub_cri_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sub_criteria.html">sub_criteria</a></span><span class="op">(</span><span class="va">event_dt</span><span class="op">$</span><span class="va">attr_1</span>, <span class="va">event_dt</span><span class="op">$</span><span class="va">attr_2</span>, </span>
<span>                          operator <span class="op">=</span> <span class="st">"or"</span>, </span>
<span>                          match_funcs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">match_funx1</span>, <span class="va">match_funx2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">event_dt</span><span class="op">$</span><span class="va">ep10</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/episodes.html">episodes</a></span><span class="op">(</span><span class="va">event_dt</span><span class="op">$</span><span class="va">date</span>, case_length <span class="op">=</span> <span class="fl">5</span>, case_sub_criteria <span class="op">=</span> <span class="va">sub_cri_1</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/schema.html">schema</a></span><span class="op">(</span><span class="va">event_dt</span><span class="op">$</span><span class="va">ep10</span>, seed <span class="op">=</span> <span class="fl">2</span>, show_labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"length_arrow"</span><span class="op">)</span>,</span>
<span>       custom_label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">event_dt</span><span class="op">$</span><span class="va">attr_1</span>, <span class="st">" in "</span>, <span class="va">event_dt</span><span class="op">$</span><span class="va">attr_2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="episodes_files/figure-html/unnamed-chunk-16-1.png" width="672"></p>
<p>Alternatively, we can specify that BSI events or those that occurred
in Ward 1 should not be linked to any episode. Note that they will be
able to start episodes unless specified otherwise (<code>y</code>) as
with <code>event_dt$ep10</code>.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">match_funx3</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="op">!</span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">attr_1</span> <span class="op">==</span> <span class="st">"BSI"</span> <span class="op">|</span> <span class="va">x</span><span class="op">$</span><span class="va">attr_2</span> <span class="op">==</span> <span class="st">"Ward 1"</span><span class="op">)</span></span>
<span><span class="va">equal_funx</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="cn">TRUE</span></span>
<span><span class="co"># Sub-criteria 1 - Matching source of infection OR patient location</span></span>
<span><span class="va">sub_cri_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sub_criteria.html">sub_criteria</a></span><span class="op">(</span><span class="fu"><a href="../reference/sub_criteria.html">attrs</a></span><span class="op">(</span>attr_1 <span class="op">=</span> <span class="va">event_dt</span><span class="op">$</span><span class="va">attr_1</span>, </span>
<span>                                attr_2 <span class="op">=</span> <span class="va">event_dt</span><span class="op">$</span><span class="va">attr_2</span><span class="op">)</span>, </span>
<span>                          operator <span class="op">=</span> <span class="st">"and"</span>, </span>
<span>                          match_funcs <span class="op">=</span> <span class="va">match_funx3</span>, </span>
<span>                          equal_funcs <span class="op">=</span> <span class="va">equal_funx</span><span class="op">)</span></span>
<span></span>
<span><span class="va">event_dt</span><span class="op">$</span><span class="va">ep11</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/episodes.html">episodes</a></span><span class="op">(</span><span class="va">event_dt</span><span class="op">$</span><span class="va">date</span>, case_length <span class="op">=</span> <span class="fl">5</span>, case_sub_criteria <span class="op">=</span> <span class="va">sub_cri_2</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/schema.html">schema</a></span><span class="op">(</span><span class="va">event_dt</span><span class="op">$</span><span class="va">ep11</span>, seed <span class="op">=</span> <span class="fl">2</span>, show_labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"length_arrow"</span><span class="op">)</span>,</span>
<span>       custom_label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">event_dt</span><span class="op">$</span><span class="va">attr_1</span>, <span class="st">" in "</span>, <span class="va">event_dt</span><span class="op">$</span><span class="va">attr_2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="episodes_files/figure-html/unnamed-chunk-18-1.png" width="672"></p>
<p>We can even combine both conditions into a nested condition.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">combined_sub_cri</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sub_criteria.html">sub_criteria</a></span><span class="op">(</span><span class="va">sub_cri_1</span>, <span class="va">sub_cri_2</span>, operator <span class="op">=</span> <span class="st">"and"</span><span class="op">)</span></span>
<span><span class="va">event_dt</span><span class="op">$</span><span class="va">ep12</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/episodes.html">episodes</a></span><span class="op">(</span><span class="va">event_dt</span><span class="op">$</span><span class="va">date</span>, case_length <span class="op">=</span> <span class="fl">5</span>, </span>
<span>                          case_sub_criteria <span class="op">=</span> <span class="va">combined_sub_cri</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/schema.html">schema</a></span><span class="op">(</span><span class="va">event_dt</span><span class="op">$</span><span class="va">ep12</span>, seed <span class="op">=</span> <span class="fl">2</span>, show_labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"length_arrow"</span><span class="op">)</span>,</span>
<span>       custom_label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">event_dt</span><span class="op">$</span><span class="va">attr_1</span>, <span class="st">" in "</span>, <span class="va">event_dt</span><span class="op">$</span><span class="va">attr_2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="episodes_files/figure-html/unnamed-chunk-20-1.png" width="672"></p>
<p>A <code>sub_criteria</code> can be very useful when complex rules are
required as part of the case definition.</p>
<p>Finally, everything we’ve just discussed can be done separately for
different subsets of the dataset by using the <code>strata</code>
argument. <code>data_source</code> lets us keep track of the source of
records in each episode. <code>data_links</code> places limits on
episode creation based on their <code>data_source</code>. The
<code>group_stats</code> argument creates useful information for each
episode which are stored in the <code>epid</code> object. To demonstrate
these, we’ll modify our first example.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">event_dt</span><span class="op">$</span><span class="va">ep13</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/episodes.html">episodes</a></span><span class="op">(</span><span class="va">event_dt</span><span class="op">$</span><span class="va">date</span>, episode_type <span class="op">=</span> <span class="st">"fixed"</span>, </span>
<span>                          strata <span class="op">=</span> <span class="va">event_dt</span><span class="op">$</span><span class="va">attr_2</span>, data_source <span class="op">=</span> <span class="va">event_dt</span><span class="op">$</span><span class="va">attr_1</span>, </span>
<span>                          group_stats <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">event_dt</span><span class="op">$</span><span class="va">ep13</span><span class="op">)</span></span>
<span><span class="co">#&gt;    epid sn     case_nm dist_wind_index dist_epid_index epid_length epid_total</span></span>
<span><span class="co">#&gt; 1     1  1        Case          0 days          0 days      7 days          4</span></span>
<span><span class="co">#&gt; 2     1  2 Duplicate_C          1 days          1 days      7 days          4</span></span>
<span><span class="co">#&gt; 3     3  3        Case          0 days          0 days      7 days          4</span></span>
<span><span class="co">#&gt; 4     3  4 Duplicate_C          1 days          1 days      7 days          4</span></span>
<span><span class="co">#&gt; 5     5  5        Case          0 days          0 days      6 days          3</span></span>
<span><span class="co">#&gt; 6     5  6 Duplicate_C          1 days          1 days      6 days          3</span></span>
<span><span class="co">#&gt; 7     1  7 Duplicate_C          6 days          6 days      7 days          4</span></span>
<span><span class="co">#&gt; 8     1  8 Duplicate_C          7 days          7 days      7 days          4</span></span>
<span><span class="co">#&gt; 9     3  9 Duplicate_C          6 days          6 days      7 days          4</span></span>
<span><span class="co">#&gt; 10    3 10 Duplicate_C          7 days          7 days      7 days          4</span></span>
<span><span class="co">#&gt; 11    5 11 Duplicate_C          6 days          6 days      6 days          3</span></span>
<span><span class="co">#&gt;    epid_dataset iteration wind_id1 wind_nm1 epid_start   epid_end</span></span>
<span><span class="co">#&gt; 1   BSI,RTI,UTI         1        1     Case 2021-01-01 2021-01-08</span></span>
<span><span class="co">#&gt; 2   BSI,RTI,UTI         1        1     Case 2021-01-01 2021-01-08</span></span>
<span><span class="co">#&gt; 3       BSI,RTI         1        3     Case 2021-01-03 2021-01-10</span></span>
<span><span class="co">#&gt; 4       BSI,RTI         1        3     Case 2021-01-03 2021-01-10</span></span>
<span><span class="co">#&gt; 5       BSI,RTI         1        5     Case 2021-01-05 2021-01-11</span></span>
<span><span class="co">#&gt; 6       BSI,RTI         1        5     Case 2021-01-05 2021-01-11</span></span>
<span><span class="co">#&gt; 7   BSI,RTI,UTI         1        1     Case 2021-01-01 2021-01-08</span></span>
<span><span class="co">#&gt; 8   BSI,RTI,UTI         1        1     Case 2021-01-01 2021-01-08</span></span>
<span><span class="co">#&gt; 9       BSI,RTI         1        3     Case 2021-01-03 2021-01-10</span></span>
<span><span class="co">#&gt; 10      BSI,RTI         1        3     Case 2021-01-03 2021-01-10</span></span>
<span><span class="co">#&gt; 11      BSI,RTI         1        5     Case 2021-01-05 2021-01-11</span></span></code></pre></div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Olisaeloka Nsonwu.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
